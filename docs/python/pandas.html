<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pandas &#8212; PowrUsr Docs alpha documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=aa5eeaf2" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=b20cc3f5" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c6eb1e0f" />
    
    <script src="../_static/documentation_options.js?v=1f169f65"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="regex" href="regex.html" />
    <link rel="prev" title="generators" href="generator.html" /><link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">main</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sphinx.html">sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash/index.html">bash</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="assert.html">assert python</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio.html">asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">itertools</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#collections">collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataclass.html">dataclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="decorators.html">decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="designpatterns.html">design patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_ops.html">glob</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html">functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="generator.html">generators</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="regex.html">regex</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">pytest</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">code library</a></li>
</ul>
</li>
</ul>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">pandas</a><ul>
<li><a class="reference internal" href="#get-df-info">get df info</a></li>
<li><a class="reference internal" href="#calculations">calculations</a></li>
<li><a class="reference internal" href="#plotting">plotting</a><ul>
<li><a class="reference internal" href="#pyplot">pyplot</a></li>
<li><a class="reference internal" href="#seaborn">seaborn</a></li>
</ul>
</li>
<li><a class="reference internal" href="#renaming-and-dropping-columns">renaming and dropping columns</a><ul>
<li><a class="reference internal" href="#rename-column">rename column</a></li>
<li><a class="reference internal" href="#drop-column">drop column</a></li>
<li><a class="reference internal" href="#rename-index">rename index</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sorting">sorting</a><ul>
<li><a class="reference internal" href="#sort-values">sort_values</a></li>
<li><a class="reference internal" href="#rank">rank</a></li>
</ul>
</li>
<li><a class="reference internal" href="#filtering">filtering</a><ul>
<li><a class="reference internal" href="#mask-helpers">mask helpers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#groupby">groupby</a><ul>
<li><a class="reference internal" href="#aggregate">aggregate</a></li>
<li><a class="reference internal" href="#multiple-groups">multiple groups</a></li>
<li><a class="reference internal" href="#binning">binning</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merge-concatenate">merge &amp; concatenate</a><ul>
<li><a class="reference internal" href="#concat">concat</a></li>
<li><a class="reference internal" href="#merge">merge</a><ul>
<li><a class="reference internal" href="#left-outer-join">left (outer) join</a></li>
<li><a class="reference internal" href="#inner-join">inner join</a></li>
<li><a class="reference internal" href="#id1">concat</a></li>
<li><a class="reference internal" href="#summary">summary</a></li>
<li><a class="reference internal" href="#full-outer-join">full outer join</a></li>
<li><a class="reference internal" href="#duplicate-keys">duplicate keys</a></li>
<li><a class="reference internal" href="#duplicate-columns">duplicate columns</a></li>
<li><a class="reference internal" href="#validating">validating</a></li>
<li><a class="reference internal" href="#merge-indicator">merge indicator</a></li>
<li><a class="reference internal" href="#composite-keys">composite keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merge-helper-functions">merge helper functions</a><ul>
<li><a class="reference internal" href="#pd-merge-ordered">pd.merge_ordered</a></li>
<li><a class="reference internal" href="#pd-merge-asof">pd.merge_asof</a></li>
<li><a class="reference internal" href="#tolerance">tolerance</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#missing-values">missing values</a><ul>
<li><a class="reference internal" href="#isna-notna">isna notna</a></li>
<li><a class="reference internal" href="#dropna">dropna</a></li>
<li><a class="reference internal" href="#isnull-notnull">isnull notnull</a></li>
<li><a class="reference internal" href="#fillna">fillna</a></li>
</ul>
</li>
<li><a class="reference internal" href="#duplicates">duplicates</a></li>
<li><a class="reference internal" href="#replace">replace</a></li>
<li><a class="reference internal" href="#tresholding-outliers">tresholding (outliers)</a></li>
<li><a class="reference internal" href="#dtype-conversion">dtype conversion</a><ul>
<li><a class="reference internal" href="#to-int">to int</a></li>
<li><a class="reference internal" href="#to-categorical">to categorical</a></li>
</ul>
</li>
<li><a class="reference internal" href="#timeseries">timeseries</a><ul>
<li><a class="reference internal" href="#timestamp">timestamp</a></li>
<li><a class="reference internal" href="#datetimeindex">datetimeindex</a></li>
<li><a class="reference internal" href="#to-datetime">to datetime</a></li>
<li><a class="reference internal" href="#using-dt-object">using dt object</a></li>
<li><a class="reference internal" href="#date-offsetting">date offsetting</a></li>
<li><a class="reference internal" href="#timedelta">timedelta</a></li>
<li><a class="reference internal" href="#datetime-filtering">datetime filtering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resample">resample</a></li>
<li><a class="reference internal" href="#apply">apply</a></li>
<li><a class="reference internal" href="#map-apply-mapapply">map apply mapapply</a><ul>
<li><a class="reference internal" href="#map">map</a></li>
<li><a class="reference internal" href="#vectorized-functions">vectorized functions</a></li>
<li><a class="reference internal" href="#applymap">applymap</a></li>
<li><a class="reference internal" href="#transform">transform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">aggregate</a><ul>
<li><a class="reference internal" href="#override-column-names-using-tuple">override column names using tuple</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-options">configure options</a><ul>
<li><a class="reference internal" href="#id3">pandas</a></li>
<li><a class="reference internal" href="#ipython">ipython</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimize-memory-usage">optimize memory usage</a></li>
<li><a class="reference internal" href="#string-manipulations">string manipulations</a></li>
<li><a class="reference internal" href="#reshaping-pivoting">reshaping &amp; pivoting</a></li>
<li><a class="reference internal" href="#un-stack-melt-explode">(un)stack melt explode</a></li>
<li><a class="reference internal" href="#importing-exporting">importing/exporting</a><ul>
<li><a class="reference internal" href="#json">json</a></li>
<li><a class="reference internal" href="#read-excel-workbooks">read excel workbooks</a></li>
<li><a class="reference internal" href="#exporting-excel-workbook">exporting excel workbook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyarrow">pyarrow</a></li>
</ul>
</li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </nav>
    </div>
</div>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="regex.html" title="regex"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="generator.html" title="generators"
             accesskey="P">previous</a> |</li>
          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="../index.html">PowrUsr Docs alpha documentation</a> &#187;
              
          </li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pandas</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pandas">
<h1>pandas<a class="headerlink" href="#pandas" title="Link to this heading">¶</a></h1>
<section id="get-df-info">
<h2>get df info<a class="headerlink" href="#get-df-info" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>  <span class="c1"># dtype columns non-null count</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span> <span class="c1"># dimensions</span>
<span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># random rows</span>
<span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>  <span class="c1"># correlations between columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1"># statistics (of numerical columns)</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="c1"># to also include categorical columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># get max for every column</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="calculations">
<h2>calculations<a class="headerlink" href="#calculations" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># mul(tiply) has fill_value for missing data</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;market_share&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">market_cap</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">total_market</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># random integers</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">nums</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
<span class="c1"># sum with don&#39;t skip na values</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># must hold a min of 3 values present in series</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># rolling sum of values </span>
<span class="n">numbers</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">market_share</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="c1"># get percentage change from last value in series (ffill by default for missing values)</span>
<span class="c1"># fill_method =&quot;bfill&quot; replace with next value observed</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
<span class="c1"># mean = avg value in the series</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># median, middle number in sorted series</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="c1"># measure variation in the data</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="c1"># describe gives count,mean,std,min,25,50,75,max values</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="c1"># give only te unique values in series or nunique</span>
<span class="n">numbers</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="c1"># arithmitic</span>
<span class="n">s1</span> <span class="o">//</span> <span class="mi">4</span>
<span class="n">s1</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span> <span class="o">!=</span>
<span class="n">s1</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="n">ne</span><span class="p">()</span>
<span class="ow">in</span> <span class="o">&amp;</span> <span class="ow">not</span> <span class="ow">in</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># tips as % of total bill</span>
<span class="n">tips</span><span class="p">[</span><span class="s2">&quot;tip_pct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s2">&quot;tip&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s2">&quot;total_bill&quot;</span><span class="p">]</span>
<span class="n">tips</span><span class="p">[</span><span class="s2">&quot;tip_pct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s2">&quot;tip_pct&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 2 decimals</span>
</pre></div>
</div>
</section>
<section id="plotting">
<h2>plotting<a class="headerlink" href="#plotting" title="Link to this heading">¶</a></h2>
<section id="pyplot">
<h3>pyplot<a class="headerlink" href="#pyplot" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">market_share</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;crypto market - Cum Market Share&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;No of Coins (Market Cap Rank)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Bum Market Share (%)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="seaborn">
<h3>seaborn<a class="headerlink" href="#seaborn" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">mpg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;mpg&#39;</span><span class="p">)</span>
<span class="n">mpg</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>  <span class="c1"># linechart</span>
<span class="n">mpg</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">)</span>  <span class="c1"># histogram</span>
<span class="n">mpg</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>  <span class="c1"># box plot</span>
<span class="n">mpg</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;barh&quot;</span><span class="p">)</span>
<span class="n">mpg</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;pie&quot;</span><span class="p">)</span>
<span class="n">mpg</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;mpg&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="renaming-and-dropping-columns">
<h2>renaming and dropping columns<a class="headerlink" href="#renaming-and-dropping-columns" title="Link to this heading">¶</a></h2>
<section id="rename-column">
<h3>rename column<a class="headerlink" href="#rename-column" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nba</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="s2">&quot;DoB&quot;</span><span class="p">,</span> <span class="s2">&quot;Pay&quot;</span><span class="p">]</span>
<span class="n">nba</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;DoB&quot;</span><span class="p">:</span> <span class="s2">&quot;Birthday&quot;</span><span class="p">})</span>
<span class="n">nba</span> <span class="o">=</span> <span class="n">nba</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;DoB&quot;</span><span class="p">:</span> <span class="s2">&quot;Birthday&quot;</span><span class="p">})</span>  <span class="c1"># to make permanent</span>
</pre></div>
</div>
</section>
<section id="drop-column">
<h3>drop column<a class="headerlink" href="#drop-column" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;tip_pct&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</section>
<section id="rename-index">
<h3>rename index<a class="headerlink" href="#rename-index" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># set another column as index of our df</span>
<span class="n">nba</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Team&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># reset_index moves current index to new column</span>
<span class="n">nba</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">nba</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Team&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># rename index column</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">:</span> <span class="s1">&#39;index&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="sorting">
<h2>sorting<a class="headerlink" href="#sorting" title="Link to this heading">¶</a></h2>
<section id="sort-values">
<h3>sort_values<a class="headerlink" href="#sort-values" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sort by total bill</span>
<span class="n">tips</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">])</span>

<span class="c1"># Total bill, descending</span>
<span class="n">tips</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Time ascending, total bill descending</span>
<span class="n">tips</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bill&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>

<span class="c1"># put nan values first when sorting</span>
<span class="n">battles</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">na_position</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
<span class="c1"># sort index</span>
<span class="n">pokemon</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stocks</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">stocks</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># sorting by multiple columns</span>
<span class="c1"># sort by Team first &amp; then by Name column</span>
<span class="n">nba</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">])</span>

<span class="c1"># always sort first = faster lookup speed</span>
<span class="c1"># w slicing</span>
<span class="n">nba</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Otto Porter&quot;</span><span class="p">:</span><span class="s2">&quot;Patrick Beverly&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">highest_lowest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">by</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
	<span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="n">highest_lowest</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;market_cap&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># 20 highest market_cap showing img&#39;s</span>
<span class="n">highest_lowest</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;market_share&quot;</span><span class="p">)</span> <span class="c1"># 20 highest market_share</span>
<span class="n">highest_lowest</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;current_price&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># 20 highest price</span>
<span class="n">highest_lowest</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;circulating_supply&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># 20 highest supply</span>
</pre></div>
</div>
</section>
<section id="rank">
<h3>rank<a class="headerlink" href="#rank" title="Link to this heading">¶</a></h3>
<p>Rank - what to do when you have equal values in a column - aka sorting with collision detection</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_price</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_price</span><span class="p">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;host_name&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
   
<span class="n">df_price</span><span class="p">[</span><span class="s2">&quot;price_rank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_price</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># rank based on avg</span>
<span class="n">df_price</span><span class="p">[[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;host_name&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;price_rank&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="filtering">
<h2>filtering<a class="headerlink" href="#filtering" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ~ helpful to just get the opposite</span>
<span class="n">below_100k</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">100000</span>
<span class="n">under_100k_earners</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="n">below_100k</span><span class="p">]</span>
<span class="mi">100</span><span class="n">k_earners</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="o">~</span><span class="n">below_100k</span><span class="p">]</span>
<span class="c1"># == eg</span>
<span class="c1"># != ne</span>
<span class="c1"># &lt; lt</span>
<span class="c1"># &lt;= le</span>
<span class="c1"># &gt; gt</span>
<span class="c1"># &gt;= ge</span>

<span class="c1"># isin (no need to create a ton of helpvars)</span>
<span class="n">all_stars_team</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Legal&quot;</span><span class="p">,</span> <span class="s2">&quot;Marketing&quot;</span><span class="p">]</span>
<span class="n">on_all_star_team</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">all_stars_team</span><span class="p">)</span>

<span class="c1"># between (works for dates &amp; strings too)</span>
<span class="n">between_80k_and_90k</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">80000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">)</span> <span class="c1"># 90k excluded</span>
<span class="n">employees</span><span class="p">[</span><span class="n">between_80k_and_90k</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># isnull &amp; notnull</span>
<span class="n">has_name</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="s2">&quot;First Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>
<span class="n">employees</span><span class="p">[</span><span class="n">has_name</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">and_operator</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)]</span>
<span class="n">or_operator</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)]</span>
</pre></div>
</div>
<p>using regex</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">th</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;th$&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtering tip amount greater than 5</span>
<span class="n">tips_over_5</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span>

<span class="n">tips</span><span class="p">[</span><span class="n">tips_over_5</span><span class="p">]</span>

<span class="c1"># Filtering tip &gt; 5 AND time = &#39;Dinner&#39;</span>
<span class="n">dinner_tips_over_5</span> <span class="o">=</span> <span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Dinner&#39;</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="n">dinner_tips_over_5</span><span class="p">]</span>

<span class="n">tips</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tip &gt; 5&#39;</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tip &gt; 5 and time == &quot;Dinner&quot;&#39;</span><span class="p">)</span>

<span class="n">some_limit</span> <span class="o">=</span> <span class="mi">85</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;column &gt; @some_limit&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;column == 3&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;column == 3 &amp; survived == 1 &amp; age &gt; 40&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;column == 3 &amp; survived == 1 &amp; (age &gt; 40 | age &lt; 10)&#39;</span><span class="p">)</span>


<span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Age&quot;</span><span class="p">]</span>
<span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="s2">&quot;Name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Miss.&quot;</span><span class="p">)</span>  <span class="c1"># returs bool series</span>
<span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="s2">&quot;Name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Miss.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>  <span class="c1"># easy count</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Mister&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>

<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;Mister&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">])</span>

<span class="c1"># use copy!</span>
<span class="n">df_fast</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Time &lt; 10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<section id="mask-helpers">
<h3>mask helpers<a class="headerlink" href="#mask-helpers" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># between</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="c1"># isin</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]),</span> <span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># is price 100 or 200</span>

<span class="c1"># you can apply mask on entire df not just column</span>
<span class="n">df</span> <span class="o">==</span> <span class="s2">&quot;John&quot;</span>
<span class="p">(</span><span class="n">df</span> <span class="o">==</span> <span class="s2">&quot;John&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>  <span class="c1"># any column that contains &quot;john&quot;</span>

<span class="c1"># now get rows! by changing default axis</span>
<span class="p">(</span><span class="n">df</span> <span class="o">==</span> <span class="s2">&quot;John&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># any column that contains &quot;john&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="groupby">
<h2>groupby<a class="headerlink" href="#groupby" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tips_grouped</span> <span class="o">=</span> <span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span>
<span class="n">tips_grouped</span>
<span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">generic</span><span class="o">.</span><span class="n">DataFrameGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x00000167F284FC40</span><span class="o">&gt;</span>
<span class="n">tips_grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">tips_grouped</span><span class="p">[[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)[[</span><span class="s1">&#39;tip&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">])[[</span><span class="s1">&#39;tip&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># market share over time</span>
<span class="n">total_mcap</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">market_cap</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># group rows into buckets based on shared values in a column</span>

<span class="c1"># eg isolate fruit &amp; vegetable rows into sep groups to perform calculations</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">supermarket</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span> <span class="c1"># pandas.core.groupby.generic.DataFrameGroupBy object</span>
<span class="n">groups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s2">&quot;Fruit&quot;</span><span class="p">)</span>

<span class="c1"># excels at aggregates</span>
<span class="n">groups</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># calculate mean per group</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	    Price</span>
<span class="sd">Type</span>
<span class="sd">Fruit	    1.4554</span>
<span class="sd">Vegetable   0.8800</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">in_retail</span> <span class="o">=</span> <span class="n">fortune</span><span class="p">[</span><span class="s2">&quot;Sector&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Retailing&quot;</span>
<span class="n">retail_companies</span> <span class="o">=</span> <span class="n">fortune</span><span class="p">[</span><span class="n">in_retail</span><span class="p">]</span>
<span class="n">retail_companies</span><span class="p">[</span><span class="s2">&quot;Revenues&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># has tbd for every sector!</span>
<span class="c1"># -&gt;</span>
<span class="n">sectors</span> <span class="o">=</span> <span class="n">fortune</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Sector&quot;</span><span class="p">)</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">fortune</span><span class="p">[</span><span class="s2">&quot;Sector&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="c1"># 21 -&gt; number of df&#39;s created for sectors</span>
<span class="c1"># view sectors</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Aerospace	25</span>
<span class="sd">Apparel		35</span>
<span class="sd">Chemicals	33</span>
<span class="sd">	...</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># view sectors as dictionaries of keys with row index positions</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">groups</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
<span class="c1"># extract row N within group</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># first row in groups</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># first 2 in each group</span>
<span class="c1"># all rows from group</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># show sum|mean|.. per sector</span>
<span class="c1"># show total revenue per sector</span>
<span class="n">sectors</span><span class="p">[</span><span class="s2">&quot;Revenues&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<section id="aggregate">
<h3>aggregate<a class="headerlink" href="#aggregate" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate multiple aggregations per sector</span>
<span class="n">aggregations</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s2">&quot;Revenues&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
	<span class="s2">&quot;Profits&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span>
	<span class="s2">&quot;Employees&quot;</span><span class="p">:</span> <span class="s2">&quot;mean&quot;</span>
<span class="p">}</span>
<span class="n">sectors</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">aggregations</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># return companies with 5 largest profits</span>
<span class="n">fortune</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Profits&quot;</span><span class="p">)</span>

<span class="c1"># groupby.apply</span>
<span class="k">def</span> <span class="nf">get_largest_row</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Revenues&quot;</span><span class="p">)</span>  <span class="c1"># only largest one</span>

<span class="n">sectors</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_largest_row</span><span class="p">)</span> <span class="c1"># calculates for each sector (df)</span>
</pre></div>
</div>
</section>
<section id="multiple-groups">
<h3>multiple groups<a class="headerlink" href="#multiple-groups" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># when combo serves as best identifier for a group</span>
<span class="n">sector_and_industry</span> <span class="o">=</span> <span class="n">fortune</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sector&quot;</span><span class="p">,</span> <span class="s2">&quot;Industry&quot;</span><span class="p">])</span>
<span class="n">sector_and_industry</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="c1"># use tuples to get all rows that belong to that group</span>
<span class="n">sectors_and_industry</span><span class="o">.</span><span class="n">get_group</span><span class="p">((</span><span class="s2">&quot;Wholesalers&quot;</span><span class="p">,</span> <span class="s2">&quot;Health Care&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store_day</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># instead of reset_index -&gt; as_index=False</span>
</pre></div>
</div>
</section>
<section id="binning">
<h3>binning<a class="headerlink" href="#binning" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># eg cut sales made</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Sales&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># (21734, 6)</span>
<span class="n">df</span><span class="o">.</span><span class="n">Sales</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>  <span class="c1"># check up to where your sales go to know where you should cut</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">count    1.017209e+06</span>
<span class="sd">mean     5.773819e+03</span>
<span class="sd">std      3.849926e+03</span>
<span class="sd">min      0.000000e+00</span>
<span class="sd">25%      3.727000e+03</span>
<span class="sd">50%      5.744000e+03</span>
<span class="sd">75%      7.856000e+03</span>
<span class="sd">max      4.155100e+04</span>
<span class="sd">Name: Sales, dtype: float64</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">]</span>
<span class="n">cuts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Sales</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">include_lowest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># cut is not attached to the dataframe itself.. , include sales with 0!</span>

<span class="c1"># add cuts back into original dataframe</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;SalesGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cuts</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;SalesGroup&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">DayOfWeek</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;SalesGroup&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">DayOfWeek</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># fill_value=0 (instead of NaN)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">DayOfWeek                  1   2   3   4   5    6    7</span>
<span class="sd">Store SalesGroup                                      </span>
<span class="sd">1     (-0.001, 2000.0]     6   1   3  11   6    0  134</span>
<span class="sd">      (2000.0, 4000.0]    28  42  42  43  28   13    0</span>
<span class="sd">      (4000.0, 6000.0]    70  80  83  72  91  109    0</span>
<span class="sd">      (6000.0, 8000.0]    26  12   7   9   9   10    0</span>
<span class="sd">      (8000.0, 10000.0]    4   0   0   0   1    2    0</span>
<span class="sd">...                       ..  ..  ..  ..  ..  ...  ...</span>
<span class="sd">1115  (2000.0, 4000.0]    15  17  15   9   0    0    0</span>
<span class="sd">      (4000.0, 6000.0]    34  54  65  64  61   36    0</span>
<span class="sd">      (6000.0, 8000.0]    30  52  39  39  50   80    0</span>
<span class="sd">      (8000.0, 10000.0]   37   9  12  10  11   16    0</span>
<span class="sd">      (10000.0, 50000.0]  12   2   1   2   7    2    0</span>

<span class="sd">[6263 rows x 7 columns]</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;SalesGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                                    Date  Sales  Customers  Open  Promo  StateHoliday  SchoolHoliday</span>
<span class="sd">Store SalesGroup         DayOfWeek                                                                  </span>
<span class="sd">1     (-0.001, 2000.0]   1             6      6          6     6      6             6              6</span>
<span class="sd">                         2             1      1          1     1      1             1              1</span>
<span class="sd">                         3             3      3          3     3      3             3              3</span>
<span class="sd">                         4            11     11         11    11     11            11             11</span>
<span class="sd">                         5             6      6          6     6      6             6              6</span>
<span class="sd">...                                  ...    ...        ...   ...    ...           ...            ...</span>
<span class="sd">1115  (10000.0, 50000.0] 3             1      1          1     1      1             1              1</span>
<span class="sd">                         4             2      2          2     2      2             2              2</span>
<span class="sd">                         5             7      7          7     7      7             7              7</span>
<span class="sd">                         6             2      2          2     2      2             2              2</span>
<span class="sd">                         7             0      0          0     0      0             0              0</span>

<span class="sd">[46830 rows x 7 columns]</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># count values that are in certain ranges</span>
<span class="n">buckets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">stocks</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">buckets</span><span class="p">)</span>
<span class="c1"># ( = excluded, ] bracket = included</span>
<span class="n">stocks</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="merge-concatenate">
<h2>merge &amp; concatenate<a class="headerlink" href="#merge-concatenate" title="Link to this heading">¶</a></h2>
<section id="concat">
<h3>concat<a class="headerlink" href="#concat" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="p">[</span><span class="n">groups1</span><span class="p">,</span> <span class="n">groups2</span><span class="p">],</span> <span class="n">ingore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># to get std index</span>
<span class="c1"># assign a key G1 &amp; G2 to multiIndex (G1 + regular old row index)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="p">[</span><span class="n">groups1</span><span class="p">,</span> <span class="n">groups2</span><span class="p">],</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;G1&quot;</span><span class="p">,</span> <span class="s2">&quot;G2&quot;</span><span class="p">])</span>

<span class="n">groups1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1">#   group_id	name 		category_id		city_id</span>
<span class="c1">#0  6388	NYC Pit Bull		26 		10001</span>
<span class="n">categories</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1">#	category_id		category_name</span>
<span class="c1"># 0 	1 			Arts &amp; Culture</span>
<span class="n">cities</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1">#  id 		city		state 	zip</span>
<span class="c1">#0 7093		West New York	   NJ	7093</span>
</pre></div>
</div>
</section>
<section id="merge">
<h3>merge<a class="headerlink" href="#merge" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">docs merge</a></p>
<ul class="simple">
<li><p>LEFT OUTER JOIN: use keys from left frame only</p></li>
<li><p>RIGHT OUTER JOIN: use keys from right frame only</p></li>
<li><p>FULL OUTER JOIN: use union of keys from both frames</p></li>
<li><p>INNER JOIN: use intersection of keys from both frames</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
       <span class="n">left</span><span class="p">,</span>
       <span class="n">right</span><span class="p">,</span>
       <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
       <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
       <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
       <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
       <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
       <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
       <span class="n">indicator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
       <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
   <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>left</strong>: A DataFrame or named Series object</p></li>
<li><p><strong>right</strong>: Another DataFrame or named Series object</p></li>
<li><p><strong>on</strong>: Column or index level names to join on. Must be found in both the left and right DataFrame and/or Series objects. If not passed and left_index and right_index are False, the intersection of the columns in the DataFrames and/or Series will be inferred to be the join keys</p></li>
<li><p><strong>left_on</strong>: Columns or index levels from the left DataFrame or Series to use as keys. Can either be column names, index level names, or arrays with length equal to the length of the DataFrame or Series</p></li>
<li><p><strong>right_on</strong>: Columns or index levels from the right DataFrame or Series to use as keys. Can either be column names, index level names, or arrays with length equal to the length of the DataFrame or Series</p></li>
<li><p><strong>left_index</strong>: If True, use the index (row labels) from the left DataFrame or Series as its join key(s). In the case of a DataFrame or Series with a MultiIndex (hierarchical), the number of levels must match the number of join keys from the right DataFrame or Series</p></li>
<li><p><strong>right_index</strong>: Same usage as left_index for the right DataFrame or Series</p></li>
<li><p><strong>how</strong>: One of ‘left’, ‘right’, ‘outer’, ‘inner’. Defaults to inner. See below for more detailed description of each method</p></li>
<li><p><strong>sort</strong>: Sort the result DataFrame by the join keys in lexicographical order. Defaults to True, setting to False will improve performance substantially in many cases</p></li>
<li><p><strong>suffixes</strong>: A tuple of string suffixes to apply to overlapping columns. Defaults to (‘_x’, ‘_y’)</p></li>
<li><p><strong>copy</strong>: Always copy data (default True) from the passed DataFrame or named Series objects, even when reindexing is not necessary. Cannot be avoided in many cases but may improve performance / memory usage. The cases where copying can be avoided are somewhat pathological but this option is provided nonetheless</p></li>
<li><p><strong>indicator</strong>: Add a column to the output DataFrame called _merge with information on the source of each row. _merge is Categorical-type and takes on a value of left_only for observations whose merge key only appears in ‘left’ DataFrame or Series, right_only for observations whose merge key only appears in ‘right’ DataFrame or Series, and both if the observation’s merge key is found in both</p></li>
<li><p><strong>validate</strong>: string, default None. If specified, checks if merge is of specified type</p>
<ul>
<li><p><strong>one_to_one</strong> or <strong>1:1</strong>: checks if merge keys are unique in both left and right datasets</p></li>
<li><p><strong>one_to_many</strong> or <strong>1:m</strong>: checks if merge keys are unique in left dataset</p></li>
<li><p><strong>many_to_one</strong> or <strong>m:1</strong>: checks if merge keys are unique in right dataset</p></li>
<li><p><strong>many_to_many</strong> or <strong>m:m</strong>: allowed, but does not result in checks</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;returns.xlsx&#39;</span><span class="p">)</span>
<span class="n">returns</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Order ID	Returned</span>
<span class="sd">0	CA-2016-142398	Yes</span>
<span class="sd">1	CA-2017-136651	Yes</span>
<span class="sd">2	US-2014-164763	Yes</span>
<span class="sd">3	US-2016-152051	Yes</span>
<span class="sd">4	CA-2017-154074	Yes</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">orders_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;orders_2.xlsx&#39;</span><span class="p">)</span>
<span class="n">orders_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Row ID	Order ID	Order Date	Category	Product Name	Sales	Quantity	Discount	Profit</span>
<span class="sd">0	7679	CA-2014-133592	42004	Office Supplies	Xerox 1970	14.94	3	0.0	7.0218</span>
<span class="sd">1	6373	CA-2017-143035	43011	Office Supplies	Quartet Alpha White Chalk, 12/Pack	6.63	3	0.0	3.1161</span>
<span class="sd">2	8424	CA-2017-150091	43020	Furniture	DAX Two-Tone Silver Metal Document Frame	40.48	2	0.0	17.4064</span>
<span class="sd">3	5333	CA-2016-123120	42617	Office Supplies	Acme Preferred Stainless Steel Scissors	22.72	4	0.0	6.5888</span>
<span class="sd">4	5596	CA-2017-160325	43002	Technology	Wi-Ex zBoost YX540 Cellular Phone Signal Booster	437.85	3	0.0	131.3550</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<section id="left-outer-join">
<h4>left (outer) join<a class="headerlink" href="#left-outer-join" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left_join</span> <span class="o">=</span> <span class="n">orders_1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">left_join</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Order ID	Order Date	Category	Product Name	Sales	Quantity	Discount	Profit	Returned</span>
<span class="sd">0	CA-2017-145429	42937	Office Supplies	GBC Premium Transparent Covers with Diagonal L...	50.352	3	0.2	17.6232	NaN</span>
<span class="sd">1	CA-2015-102015	42259	Office Supplies	Tyvek Top-Opening Peel &amp; Seel Envelopes, Plai...	27.180	1	0.0	12.7746	NaN</span>
<span class="sd">2	CA-2017-135860	43070	Office Supplies	Avery Durable Slant Ring Binders, No Labels	15.920	4	0.0	7.4824	NaN</span>
<span class="sd">3	CA-2017-128363	42960	Office Supplies	Colored Envelopes	14.760	5	0.2	4.7970	NaN</span>
<span class="sd">4	CA-2015-142692	42300	Office Supplies	Avery Non-Stick Binders	3.592	1	0.2	1.1225	NaN</span>
<span class="sd">5	CA-2017-156237	42992	Technology	Ricoh - Ink Collector Unit for GX3000 Series P...	12.585	1	0.7	-18.0385	NaN</span>
<span class="sd">6	CA-2017-117212	42792	Office Supplies	Kensington 6 Outlet Guardian Standard Surge Pr...	81.920	4	0.0	22.1184	NaN</span>
<span class="sd">7	US-2015-164175	42124	Furniture	Global Value Mid-Back Manager&#39;s Chair, Gray	213.115	5	0.3	-15.2225	NaN</span>
<span class="sd">8	CA-2014-119032	41970	Office Supplies	Staples	3.760	2	0.0	1.3160	NaN</span>
<span class="sd">9	CA-2017-153787	42874	Office Supplies	Belkin Premiere Surge Master II 8-outlet surge...	97.160	2	0.0	28.1764	NaN</span>
<span class="sd">10	CA-2016-121370	42688	Furniture	Global Ergonomic Managers Chair	380.058	3	0.3	-21.7176	NaN</span>
<span class="sd">11	CA-2016-109365	42677	Office Supplies	Avery Durable Plastic 1&quot; Binders	43.584	12	0.2	15.7992	Yes</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">left_join</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="inner-join">
<h4>inner join<a class="headerlink" href="#inner-join" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">orders_1</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">inner_join</span> <span class="o">=</span> <span class="n">orders_1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">inner_join</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Order ID	Order Date	Category	Product Name	Sales	Quantity	Discount	Profit	Returned</span>
<span class="sd">0	CA-2016-109365	42677	Office Supplies	Avery Durable Plastic 1&quot; Binders	43.584	12	0.2	15.7992	Yes</span>
<span class="sd">1	CA-2016-151561	42614	Technology	Enermax Aurora Lite Keyboard	468.900	6	0.0	206.3160	Yes</span>
<span class="sd">2	US-2016-103674	42710	Office Supplies	Ibico Recycled Linen-Style Covers	437.472	14	0.2	153.1152	Yes</span>
<span class="sd">3	CA-2016-146157	42695	Technology	Lenovo 17-Key USB Numeric Keypad	81.576	3	0.2	2.0394	Yes</span>
<span class="sd">4	CA-2017-152310	42959	Office Supplies	Xerox 1937	192.160	4	0.0	92.2368	Yes</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">inner_join</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id1">
<h4>concat<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">orders_append</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">orders_1</span><span class="p">,</span> <span class="n">orders_2</span><span class="p">])</span>
<span class="n">orders_append</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">110</span>
<span class="c1"># are row counts the same? </span>
<span class="n">orders_append</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">orders_1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">orders_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="summary">
<h4>summary<a class="headerlink" href="#summary" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># join can only target rows with shared values between both data sets</span>

<span class="c1"># left join (A &#39;groups&#39; is focus, add B &#39;categories&#39; with same cat_id&#39;s)</span>
<span class="n">groups</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;category_id&quot;</span><span class="p">)</span>

<span class="c1"># inner join (only categories data that exists in both df&#39;s)</span>
<span class="n">groups</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;category_id&quot;</span><span class="p">)</span>

<span class="c1"># outer join (combine all values from both df&#39;s)</span>
<span class="n">groups</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cities</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;city_id&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>

<span class="c1"># merging on index labels</span>
<span class="c1"># right_index=True -&gt; look for city_id in cities df</span>
<span class="n">groups</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cities</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;city_id&quot;</span><span class="p">,</span><span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># indicator=True -&gt; adds left_ or right_ to string</span>
</pre></div>
</div>
</section>
<section id="full-outer-join">
<h4>full outer join<a class="headerlink" href="#full-outer-join" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">df_b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]})</span>


<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A  B    C</span>
<span class="sd">0  x  1  3.0</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A    B    C</span>
<span class="sd">0  x  1.0  3.0</span>
<span class="sd">1  y  2.0  NaN</span>
<span class="sd">2  z  3.0  NaN</span>
<span class="sd">3  u  NaN  5.0</span>
<span class="sd">4  v  NaN  4.0</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="duplicate-keys">
<h4>duplicate keys<a class="headerlink" href="#duplicate-keys" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">df_d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_c</span><span class="p">,</span> <span class="n">df_d</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A  B    C</span>
<span class="sd">0  x  1  4.0   x1 * x4.0</span>
<span class="sd">1  x  1  3.0   x2 * x3.0</span>
<span class="sd">2  x  2  4.0   dito</span>
<span class="sd">3  x  2  3.0   dito</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="duplicate-columns">
<h4>duplicate columns<a class="headerlink" href="#duplicate-columns" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_e</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">df_f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_e</span><span class="p">,</span> <span class="n">df_f</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A  B_x  B_y</span>
<span class="sd">0  x    1  3.0</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">df_m</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_e</span><span class="p">,</span> <span class="n">df_f</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_left&quot;</span><span class="p">,</span> <span class="s2">&quot;_right&quot;</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A  B_left  B_right</span>
<span class="sd">0  x       1      3.0</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">df_m</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;B_left&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;B_right&quot;</span><span class="p">:</span> <span class="s2">&quot;Obi_wan_kenobi&quot;</span><span class="p">})</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A  Hello  Obi_wan_kenobi</span>
<span class="sd">0  x      1             3.0</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="validating">
<h4>validating<a class="headerlink" href="#validating" title="Link to this heading">¶</a></h4>
<p>Users can use the <strong>validate</strong> argument to automatically check whether there are unexpected duplicates in their merge keys. Key uniqueness is checked before merge operations and so should protect against memory overflows. Checking key uniqueness is also a good way to ensure user data structures are as expected</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_one&quot;</span><span class="p">)</span>
<span class="c1"># MergeError: Merge keys are not unique in right dataset; not a one-to-one merge</span>
</pre></div>
</div>
<p>If the user is aware of the duplicates in the right DataFrame but wants to ensure there are no duplicates in the left DataFrame, one can use the <strong>validate=’one_to_many’</strong> argument instead, which will not raise an exception</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_many&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   A_x  B  A_y</span>
<span class="sd">0    1  1  NaN</span>
<span class="sd">1    2  2  4.0</span>
<span class="sd">2    2  2  5.0</span>
<span class="sd">3    2  2  6.0</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_s</span><span class="p">,</span> <span class="n">df_p</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;student_id&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_one&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="merge-indicator">
<h4>merge indicator<a class="headerlink" href="#merge-indicator" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;col_left&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;col_right&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   col1 col_left  col_right      _merge</span>
<span class="sd">0     0        a        NaN   left_only</span>
<span class="sd">1     1        b        2.0        both</span>
<span class="sd">2     2      NaN        2.0  right_only</span>
<span class="sd">3     2      NaN        2.0  right_only</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>The indicator argument will also accept string arguments, in which case the indicator function will use the value of the passed string as the name for the indicator column</p>
</section>
<section id="composite-keys">
<h4>composite keys<a class="headerlink" href="#composite-keys" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span> <span class="s2">&quot;sem&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;fee&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">]})</span>
<span class="n">df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span> <span class="s2">&quot;sem&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                     <span class="s2">&quot;student&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;discount&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">df_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;student&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="n">combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_1</span><span class="p">,</span> <span class="n">df_2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;sem&quot;</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   year  sem  fee  student  discount</span>
<span class="sd">0  2000    1  200        1       0.1</span>
<span class="sd">1  2000    2  200        2       0.2</span>
<span class="sd">2  2001    1  200        2       0.2</span>
<span class="sd">3  2001    2  200        3       1.0</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">combined</span><span class="p">[</span><span class="s2">&quot;due_fee&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">fee</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">combined</span><span class="o">.</span><span class="n">discount</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   year  sem  fee  student  discount  due_fee</span>
<span class="sd">0  2000    1  200        1       0.1    180.0</span>
<span class="sd">1  2000    2  200        2       0.2    160.0</span>
<span class="sd">2  2001    1  200        2       0.2    160.0</span>
<span class="sd">3  2001    2  200        3       1.0      0.0</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># after merging we don&#39;t need key column (axis=1) anymore</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_3</span><span class="p">,</span> <span class="n">df_2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;student&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   student    year  sem  discount</span>
<span class="sd">0        1  2000.0  1.0       0.1</span>
<span class="sd">1        2  2000.0  2.0       0.2</span>
<span class="sd">2        2  2001.0  1.0       0.2</span>
<span class="sd">3        3  2001.0  2.0       1.0</span>
<span class="sd">4        4     NaN  NaN       NaN</span>
<span class="sd">5        5     NaN  NaN       NaN</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># cross join aka cartesian product</span>
<span class="n">df_1</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">],</span> <span class="n">df_3</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">df_cross</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_1</span><span class="p">,</span> <span class="n">df_3</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    year  sem  fee  student</span>
<span class="sd">0   2000    1  200        1</span>
<span class="sd">1   2000    1  200        2</span>
<span class="sd">2   2000    1  200        3</span>
<span class="sd">3   2000    1  200        4</span>
<span class="sd">4   2000    1  200        5</span>
<span class="sd">..   ...  ...  ...      ...</span>
<span class="sd">15  2001    2  200        1</span>
<span class="sd">16  2001    2  200        2</span>
<span class="sd">17  2001    2  200        3</span>
<span class="sd">18  2001    2  200        4</span>
<span class="sd">19  2001    2  200        5</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">all_fees</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cross</span><span class="p">,</span> <span class="n">df_2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;student&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;sem&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    year  sem  fee  student  discount</span>
<span class="sd">0   2000    1  200        1       0.1</span>
<span class="sd">1   2000    1  200        2       NaN</span>
<span class="sd">2   2000    1  200        3       NaN</span>
<span class="sd">3   2000    1  200        4       NaN</span>
<span class="sd">4   2000    1  200        5       NaN</span>
<span class="sd">..   ...  ...  ...      ...       ...</span>
<span class="sd">15  2001    2  200        1       NaN</span>
<span class="sd">16  2001    2  200        2       NaN</span>
<span class="sd">17  2001    2  200        3       1.0</span>
<span class="sd">18  2001    2  200        4       NaN</span>
<span class="sd">19  2001    2  200        5       NaN</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">all_fees</span><span class="o">.</span><span class="n">discount</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">all_fees</span><span class="p">[</span><span class="s2">&quot;due&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_fees</span><span class="o">.</span><span class="n">fee</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">all_fees</span><span class="o">.</span><span class="n">discount</span><span class="p">)</span>
<span class="n">all_fees</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    year  sem  fee  student  discount    due</span>
<span class="sd">0   2000    1  200        1       0.1  180.0</span>
<span class="sd">1   2000    1  200        2       0.0  200.0</span>
<span class="sd">2   2000    1  200        3       0.0  200.0</span>
<span class="sd">3   2000    1  200        4       0.0  200.0</span>
<span class="sd">4   2000    1  200        5       0.0  200.0</span>
<span class="sd">..   ...  ...  ...      ...       ...    ...</span>
<span class="sd">15  2001    2  200        1       0.0  200.0</span>
<span class="sd">16  2001    2  200        2       0.0  200.0</span>
<span class="sd">17  2001    2  200        3       1.0    0.0</span>
<span class="sd">18  2001    2  200        4       0.0  200.0</span>
<span class="sd">19  2001    2  200        5       0.0  200.0</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="merge-helper-functions">
<h3>merge helper functions<a class="headerlink" href="#merge-helper-functions" title="Link to this heading">¶</a></h3>
<section id="pd-merge-ordered">
<h4>pd.merge_ordered<a class="headerlink" href="#pd-merge-ordered" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ffill = forward fill (take previous value if NaN)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge_ordered</span><span class="p">(</span><span class="n">df_be</span><span class="p">,</span> <span class="n">df_nl</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_be&quot;</span><span class="p">,</span> <span class="s2">&quot;_nl&quot;</span><span class="p">),</span> <span class="n">fill_method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pd-merge-asof">
<h4>pd.merge_asof<a class="headerlink" href="#pd-merge-asof" title="Link to this heading">¶</a></h4>
<p>A merge_asof() is similar to an ordered left-join except that we match on nearest key rather than equal keys. For each row in the left DataFrame, we select the last row in the right DataFrame whose on key is less than the left’s key. Both DataFrames must be sorted by the key</p>
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.asof.html</p>
<p>get closest or partial match</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">df_both</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge_ordered</span><span class="p">(</span><span class="n">df_be</span><span class="p">,</span> <span class="n">df_nl</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_be&quot;</span><span class="p">,</span> <span class="s2">&quot;_nl&quot;</span><span class="p">),</span> <span class="n">fill_method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">)</span>
   <span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">df_both</span><span class="p">,</span> <span class="n">df_bris</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="s2">&quot;temperature_bxl&quot;</span><span class="p">})</span>
   <span class="n">df_all</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;temperature_be&quot;</span><span class="p">,</span> <span class="s2">&quot;temperature_nl&quot;</span><span class="p">,</span> <span class="s2">&quot;temperature_bxl&quot;</span><span class="p">])</span>
   <span class="c1"># on=&quot;date&quot;, tolerance=pd.Timedelta(&quot;14 days&quot;), direction=&quot;neares&quot;</span>
</pre></div>
</div>
</section>
<section id="tolerance">
<h4>tolerance<a class="headerlink" href="#tolerance" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">144</span><span class="p">]:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span>
   <span class="o">.....</span><span class="p">:</span>     <span class="n">trades</span><span class="p">,</span>
   <span class="o">.....</span><span class="p">:</span>     <span class="n">quotes</span><span class="p">,</span>
   <span class="o">.....</span><span class="p">:</span>     <span class="n">on</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
   <span class="o">.....</span><span class="p">:</span>     <span class="n">by</span><span class="o">=</span><span class="s2">&quot;ticker&quot;</span><span class="p">,</span>
   <span class="o">.....</span><span class="p">:</span>     <span class="n">tolerance</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;10ms&quot;</span><span class="p">),</span>
   <span class="o">.....</span><span class="p">:</span>     <span class="n">allow_exact_matches</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
   <span class="o">.....</span><span class="p">:</span> <span class="p">)</span>
   <span class="o">.....</span><span class="p">:</span> 
<span class="n">Out</span><span class="p">[</span><span class="mi">144</span><span class="p">]:</span> 
                     <span class="n">time</span> <span class="n">ticker</span>   <span class="n">price</span>  <span class="n">quantity</span>    <span class="n">bid</span>    <span class="n">ask</span>
<span class="mi">0</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.023</span>   <span class="n">MSFT</span>   <span class="mf">51.95</span>        <span class="mi">75</span>    <span class="n">NaN</span>    <span class="n">NaN</span>
<span class="mi">1</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.038</span>   <span class="n">MSFT</span>   <span class="mf">51.95</span>       <span class="mi">155</span>  <span class="mf">51.97</span>  <span class="mf">51.98</span>
<span class="mi">2</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.048</span>   <span class="n">GOOG</span>  <span class="mf">720.77</span>       <span class="mi">100</span>    <span class="n">NaN</span>    <span class="n">NaN</span>
<span class="mi">3</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.048</span>   <span class="n">GOOG</span>  <span class="mf">720.92</span>       <span class="mi">100</span>    <span class="n">NaN</span>    <span class="n">NaN</span>
<span class="mi">4</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mf">00.048</span>   <span class="n">AAPL</span>   <span class="mf">98.00</span>       <span class="mi">100</span>    <span class="n">NaN</span>    <span class="n">NaN</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="missing-values">
<h2>missing values<a class="headerlink" href="#missing-values" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>df.dropna()</strong>: drop all or some of the rows that have missing values</p></li>
<li><p><strong>df.fillna()</strong>: replace the rows that have missing values with that you pass in</p></li>
</ul>
<section id="isna-notna">
<h3>isna notna<a class="headerlink" href="#isna-notna" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">max_supply</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">max_supply</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">max_supply</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">max_supply</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">species               0</span>
<span class="sd">island                0</span>
<span class="sd">bill_length_mm        2</span>
<span class="sd">bill_depth_mm         2</span>
<span class="sd">flipper_length_mm     2</span>
<span class="sd">body_mass_g           2</span>
<span class="sd">sex                  11</span>
<span class="sd">dtype: int64</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">penguins</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">species              0.000000</span>
<span class="sd">island               0.000000</span>
<span class="sd">bill_length_mm       0.005814</span>
<span class="sd">bill_depth_mm        0.005814</span>
<span class="sd">flipper_length_mm    0.005814</span>
<span class="sd">body_mass_g          0.005814</span>
<span class="sd">sex                  0.031977</span>
<span class="sd">dtype: float64</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
</section>
<section id="dropna">
<h3>dropna<a class="headerlink" href="#dropna" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>  <span class="c1"># rows you would have when no NaN values</span>

<span class="c1"># you can say only drop it when a row has at least 3 NaN&#39;s in it</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1"># only drop events that have &quot;last_review&quot; = Nan</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;last_review&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>  <span class="c1"># by default we operate on row by row basis</span>

<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>  <span class="c1"># you now dropped the entire review column cuz it had a NaN in it</span>
   
<span class="n">penguins</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">species              0.0</span>
<span class="sd">island               0.0</span>
<span class="sd">bill_length_mm       0.0</span>
<span class="sd">bill_depth_mm        0.0</span>
<span class="sd">flipper_length_mm    0.0</span>
<span class="sd">body_mass_g          0.0</span>
<span class="sd">sex                  0.0</span>
<span class="sd">dtype: float64</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">employees</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span> <span class="c1"># rows where all are NaN</span>
<span class="n">employees</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">)</span> <span class="c1"># rows where any are NaN</span>
<span class="n">employees</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">])</span> <span class="c1"># remove rows when Nan in Gender column</span>
<span class="n">employees</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">tresh</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># must have a min of 4 non-null values</span>
</pre></div>
</div>
</section>
<section id="isnull-notnull">
<h3>isnull notnull<a class="headerlink" href="#isnull-notnull" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">null</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">null</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
<span class="n">notnull</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>

</pre></div>
</div>
</section>
<section id="fillna">
<h3>fillna<a class="headerlink" href="#fillna" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_fix</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Sales</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>


<span class="c1"># df.fillna(0)</span>
<span class="c1"># if eg you have number_of_items = 0 -&gt; you want total_purchased to be 0 instead of NaN</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># replaces every nan with a 0</span>
<span class="c1"># for time-series data you can use method like backfill forwardfill (eg fill with previous finite value)</span>


<span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Mgmt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Mgmt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># nans become true so beware</span>
<span class="c1"># remove Nans eg with fillna &amp; then you&#39;ll be able to convert float to ints</span>
<span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>  <span class="c1"># 0 just an example</span>
<span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="duplicates">
<h2>duplicates<a class="headerlink" href="#duplicates" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>  <span class="c1"># keep first or last occurence</span>

<span class="n">first_person_in_team</span> <span class="o">=</span> <span class="o">~</span><span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="n">employees</span><span class="p">[</span><span class="n">first_person_in_team</span><span class="p">]</span>

<span class="n">employees</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>  <span class="c1"># drop if all values are equal</span>

<span class="c1"># last employee on team</span>
<span class="n">employees</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>

<span class="c1"># exclude all rows with duplicate values with keep=False</span>
<span class="c1"># first names that occur only ones:</span>
<span class="n">employees</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;First Name&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="replace">
<h2>replace<a class="headerlink" href="#replace" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Jono&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># on every row and every column by default</span>
<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Jono&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># John is on 1st row, set a replacement limit</span>
<span class="n">df</span><span class="o">.</span><span class="n">host_name</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;John&quot;</span><span class="p">:</span> <span class="s2">&quot;Jono&quot;</span><span class="p">,</span> <span class="s2">&quot;James&quot;</span><span class="p">:</span> <span class="s2">&quot;Jamey&quot;</span><span class="p">})</span>  <span class="c1"># on every row and every column by default</span>
</pre></div>
</div>
</section>
<section id="tresholding-outliers">
<h2>tresholding (outliers)<a class="headerlink" href="#tresholding-outliers" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.hist(df.price, log=True)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">df_copy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_copy</span><span class="o">.</span><span class="n">price</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># identical to .clip(upper=1000)</span>
</pre></div>
</div>
</section>
<section id="dtype-conversion">
<h2>dtype conversion<a class="headerlink" href="#dtype-conversion" title="Link to this heading">¶</a></h2>
<section id="to-int">
<h3>to int<a class="headerlink" href="#to-int" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># always convert a string to float first b4 converting to an int</span>
<span class="nb">print</span><span class="p">(</span><span class="n">astro_df</span><span class="o">.</span><span class="n">age_at_zarya</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">))</span>  <span class="c1"># first astype(&quot;str&quot;) for demo only</span>
</pre></div>
</div>
</section>
<section id="to-categorical">
<h3>to categorical<a class="headerlink" href="#to-categorical" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">astro_df</span><span class="p">[</span><span class="s2">&quot;Military Rank&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="c1"># [nan &#39;Colonel&#39; &#39;Lieutenant Colonel&#39; &#39;Captain&#39; &#39;Major General&#39; &#39;Commander&#39; &#39;Lieutenant Commander&#39; &#39;Brigadier General&#39; &#39;Major&#39; &#39;Lieutenant General&#39; &#39;Chief Warrant Officer&#39; &#39;Rear Admiral&#39; &#39;Vice Admiral&#39;]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">astro_df</span><span class="p">[</span><span class="s2">&quot;Military Rank&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># object</span>
<span class="c1"># turn military into a categorical with &quot;category&quot;</span>
<span class="n">astro_df</span><span class="p">[</span><span class="s2">&quot;Military Rank&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="n">astro_df</span><span class="p">[</span><span class="s2">&quot;Military Rank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">astro_df</span><span class="p">[</span><span class="s2">&quot;Military Rank&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>  <span class="c1"># overwrite orginal mil rank</span>
<span class="nb">print</span><span class="p">(</span><span class="n">astro_df</span><span class="p">[</span><span class="s2">&quot;Military Rank&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># category -&gt; no longer a generic object</span>
</pre></div>
</div>
</section>
</section>
<section id="timeseries">
<h2>timeseries<a class="headerlink" href="#timeseries" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#time-date-components">timeseries docs</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;mydata.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>

<span class="c1"># create series, not a dataframe with squeeze=True</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;pokemon.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Pokemon&quot;</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># read as datetime &amp; not string</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;stocks.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>

<span class="c1"># usecols to only import these columns</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;stocks.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Startdate&quot;</span><span class="p">,</span> <span class="s2">&quot;Date&quot;</span><span class="p">],</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! pip install vega_datasets</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">vega_datasets</span> <span class="kn">import</span> <span class="n">local_data</span>

<span class="n">seattle</span> <span class="o">=</span> <span class="n">local_data</span><span class="o">.</span><span class="n">seattle_weather</span><span class="p">()</span>
<span class="n">seattle</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">date	precipitation	temp_max	temp_min	wind	weather</span>
<span class="sd">0	2012-01-01	0.0	12.8	5.0	4.7	drizzle</span>
<span class="sd">1	2012-01-02	10.9	10.6	2.8	4.5	rain</span>
<span class="sd">2	2012-01-03	0.8	11.7	7.2	2.3	rain</span>
<span class="sd">3	2012-01-04	20.3	12.2	5.6	4.7	rain</span>
<span class="sd">4	2012-01-05	1.3	8.9	2.8	6.1	rain</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">seattle</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">0        1</span>
<span class="sd">1        1</span>
<span class="sd">2        1</span>
<span class="sd">3        1</span>
<span class="sd">4        1</span>
<span class="sd">        ..</span>
<span class="sd">1456    12</span>
<span class="sd">1457    12</span>
<span class="sd">1458    12</span>
<span class="sd">1459    12</span>
<span class="sd">1460    12</span>
<span class="sd">Name: date, Length: 1461, dtype: int64</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">seattle</span><span class="p">[</span><span class="s1">&#39;month_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seattle</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month_name</span><span class="p">()</span>
<span class="n">seattle</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">date	precipitation	temp_max	temp_min	wind	weather	month_name</span>
<span class="sd">0	2012-01-01	0.0	12.8	5.0	4.7	drizzle	January</span>
<span class="sd">1	2012-01-02	10.9	10.6	2.8	4.5	rain	January</span>
<span class="sd">2	2012-01-03	0.8	11.7	7.2	2.3	rain	January</span>
<span class="sd">3	2012-01-04	20.3	12.2	5.6	4.7	rain	January</span>
<span class="sd">4	2012-01-05	1.3	8.9	2.8	6.1	rain	January</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">seattle</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">seattle</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">precipitation	temp_max	temp_min	wind	weather	month_name</span>
<span class="sd">date						</span>
<span class="sd">2012-01-01	0.0	12.8	5.0	4.7	drizzle	January</span>
<span class="sd">2012-01-02	10.9	10.6	2.8	4.5	rain	January</span>
<span class="sd">2012-01-03	0.8	11.7	7.2	2.3	rain	January</span>
<span class="sd">2012-01-04	20.3	12.2	5.6	4.7	rain	January</span>
<span class="sd">2012-01-05	1.3	8.9	2.8	6.1	rain	January</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">seattle</span><span class="p">[</span><span class="s1">&#39;precipitation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;2W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">date</span>
<span class="sd">2012-01-01    0.000000</span>
<span class="sd">2012-01-15    3.607143</span>
<span class="sd">2012-01-29    8.385714</span>
<span class="sd">2012-02-12    2.057143</span>
<span class="sd">2012-02-26    4.607143</span>
<span class="sd">Freq: 2W-SUN, Name: precipitation, dtype: float64</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="n">seattle</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">seattle</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">date	precipitation	temp_max	temp_min	wind	weather	month_name</span>
<span class="sd">0	2012-01-01	0.0	12.8	5.0	4.7	drizzle	January</span>
<span class="sd">1	2012-01-02	10.9	10.6	2.8	4.5	rain	January</span>
<span class="sd">2	2012-01-03	0.8	11.7	7.2	2.3	rain	January</span>
<span class="sd">3	2012-01-04	20.3	12.2	5.6	4.7	rain	January</span>
<span class="sd">4	2012-01-05	1.3	8.9	2.8	6.1	rain	January</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
<section id="timestamp">
<h3>timestamp<a class="headerlink" href="#timestamp" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pandas uses Timestamp object ipv Datetime</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2015-03-31&quot;</span><span class="p">)</span> <span class="c1"># string becomes timestamp</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2015/03/31&quot;</span><span class="p">)</span> <span class="c1"># string becomes timestamp</span>

<span class="c1"># Timestamp(&#39;2015-03-31 00:00:00&#39;)</span>
<span class="n">my_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>

<span class="c1"># Timestamp(&#39;2000-02-03 21:35:22&#39;)</span>
<span class="n">my_time</span><span class="o">.</span><span class="n">year</span>  <span class="c1"># immutable!</span>
<span class="n">my_time</span><span class="o">.</span><span class="n">second</span>  <span class="c1"># immutable!</span>
</pre></div>
</div>
</section>
<section id="datetimeindex">
<h3>datetimeindex<a class="headerlink" href="#datetimeindex" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">string_dates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2018/01/02&quot;</span><span class="p">,</span><span class="s2">&quot;2016/04/12&quot;</span><span class="p">,</span><span class="s2">&quot;2009/09/07&quot;</span><span class="p">]</span>
<span class="n">dt_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">string_dates</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dt_index</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="to-datetime">
<h3>to datetime<a class="headerlink" href="#to-datetime" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">disney</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;disney.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>
<span class="n">dt_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">string_dates</span><span class="p">)</span>
<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="using-dt-object">
<h3>using dt object<a class="headerlink" href="#using-dt-object" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># returns day series</span>
<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;DayofWeek&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>

<span class="c1"># group based on weekday</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">disney</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;DayofWeek&quot;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		High 	Low 	Open 	Close</span>
<span class="sd">DayofWeek</span>
<span class="sd">Friday		23.77	23.21 	23.45 	23.55</span>
<span class="sd">Monday	 ..</span>
<span class="sd">Thursday ..</span>
<span class="sd">Tuesday  ..</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month_name</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># dates that fell on start of quarter boolean</span>
<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_quarter_start</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># on 01/01..</span>
<span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_quarter_end</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># on 31/03..</span>

<span class="n">dates_at_month_start</span> <span class="o">=</span> <span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_month_start</span>
<span class="n">dates_at_month_end</span> <span class="o">=</span> <span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_month_end</span>

<span class="n">disney</span><span class="p">[</span><span class="n">dates_at_month_start</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">disney</span><span class="p">[</span><span class="n">dates_at_month_end</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">dates_at_year_start</span> <span class="o">=</span> <span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_year_start</span>
</pre></div>
</div>
</section>
<section id="date-offsetting">
<h3>date offsetting<a class="headerlink" href="#date-offsetting" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># adding &amp; subtracting durations of time</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">months</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># add 5 days correction</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2023-03-28T17:05.12&quot;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;M8[ns]&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2023-04-28 17:05:07&#39;</span><span class="p">)</span>

<span class="c1"># round date to end of month</span>
<span class="p">(</span><span class="n">disney</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">())</span> <span class="c1"># 30/06 become 31/07 can&#39;t round to same date</span>
<span class="c1"># use - to go back</span>
<span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">BMonthEnd</span><span class="p">()</span> <span class="c1"># BusinessMonthEnd</span>
</pre></div>
</div>
</section>
<section id="timedelta">
<h3>timedelta<a class="headerlink" href="#timedelta" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timedeltas.html">timedelta docs</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span>
	<span class="n">weeks</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
	<span class="n">days</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
	<span class="n">hours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
	<span class="n">minutes</span><span class="o">=</span><span class="mi">58</span><span class="p">,</span>
	<span class="n">seconds</span><span class="o">=</span><span class="mi">12</span>
	<span class="p">)</span>
<span class="c1"># Output: datetime.timedelta(days=62, seconds=14292)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Timedelta object (distance between two durations) note capital T</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span>
	<span class="n">days</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
	<span class="n">hours</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
	<span class="n">minutes</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
	<span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
	
<span class="n">duration</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="s2">&quot;3 hours, 5 minutes, 12 seconds&quot;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;hour&quot;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">)</span>
<span class="c1"># TimedeltaIndex([&#39;5 days&#39;, &#39;10 days&#39;, &#39;15 days&#39;]), dtype=&#39;timedelta64[ns]&#39;, freq=None)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1999-02-05&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1998-05-24&quot;</span><span class="p">)</span>
<span class="c1"># Timedelta(&#39;257 days 00:00:00&#39;)</span>

<span class="c1"># packages that took +1 year to deliver</span>
<span class="p">(</span><span class="n">deliveries</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">))</span> <span class="c1"># or</span>
<span class="p">(</span><span class="n">deliveries</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s2">&quot;365 days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="datetime-filtering">
<h3>datetime filtering<a class="headerlink" href="#datetime-filtering" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;now&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>
<span class="n">s3</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   2021-01-31 16:41:31.879768    a</span>
<span class="sd">   2021-02-28 16:41:31.879768    b</span>
<span class="sd">   2021-03-31 16:41:31.879768    c</span>
<span class="sd">   2021-04-30 16:41:31.879768    d</span>
<span class="sd">   2021-05-31 16:41:31.879768    e</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get row where index = datetime</span>
<span class="c1"># row_of_interest = df[ column_Series == date_given]</span>
<span class="n">result_row</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2023-01-05&quot;</span><span class="p">]</span>

<span class="c1"># get row where columns are datetime</span>
<span class="n">date_in_columns_bool</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2023-01-05&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="ow">in</span> <span class="n">us_yields_df</span><span class="o">.</span><span class="n">columns</span>

<span class="n">give_index</span> <span class="o">=</span> <span class="n">us_yields_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2023-01-05&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>

<span class="n">give_row</span> <span class="o">=</span> <span class="n">us_yields_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;2023-01-05&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">:</span><span class="s1">&#39;2014-02-01&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;20130101 &lt; date &lt; 20130201&#39;</span><span class="p">)</span>
<span class="c1"># using datetime object</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2014</span><span class="p">,</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2014</span><span class="p">,</span><span class="n">month</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="c1"># using date</span>
<span class="c1"># recommended to use Timestamp rather than date</span>
<span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))]</span> 
<span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))]</span>
<span class="c1"># if already applied pd.to_datetime just do</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s2">&quot;2018-01-01&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="s2">&quot;2019-07-01&quot;</span><span class="p">)]</span>

<span class="n">value_to_check</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">filter_mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date_column&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">value_to_check</span>
<span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">filter_mask</span><span class="p">]</span>

<span class="c1"># if the dates are in the index then simply:</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;20160101&#39;</span><span class="p">:</span><span class="s1">&#39;20160301&#39;</span><span class="p">]</span>

<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;date &gt; 20190515071320&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;date &gt; &quot;20190515071320&quot;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;date &gt; &quot;2019-05-15 07:13:20&quot;&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ColumnName</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># datetime based index descending order</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2021-08-01&#39;</span><span class="p">:</span><span class="s1">&#39;2021-08-31&#39;</span><span class="p">]</span>
<span class="c1"># returns empty</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2021-08-31&#39;</span><span class="p">:</span><span class="s1">&#39;2021-08-01&#39;</span><span class="p">]</span>
<span class="c1"># returns expected data</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2"> &lt; MyDate &lt; </span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 60 days from today</span>
<span class="n">after_60d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;today&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="c1"># filter date col less than 60 days date</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date_col&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">after_60d</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">date_filter</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s1">&#39;2020-05-01&#39;</span><span class="p">]</span>
<span class="n">date_filter2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2020-05-01&#39;</span><span class="p">]</span>
<span class="n">date_filter3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s1">&#39;2020-05-01&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="s1">&#39;2020-06-01&#39;</span><span class="p">)]</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Months&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Weekday&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Weekday Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday_name</span>

<span class="n">tuesdays</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="resample">
<h2>resample<a class="headerlink" href="#resample" title="Link to this heading">¶</a></h2>
<p>allows you to resample a dataset with a timeseries index
The method accepts a periodicity that you want to resample to, such as ‘W’ for week or ‘H’ for hour</p>
<p>Since you’ll want to provide some method by which to invent your data, you can chain in another method, such as .mean(), to resample with that aggregation function</p>
<p>Let’s resample our hourly data to daily data</p>
<p>The process of resampling refers to changing the frequency of your data. You have two main methods available when you want to resample your timeseries data:</p>
<p><strong>Upsampling</strong>: increasing the frequency of your data, such as from hours to minutes
<strong>Downsampling</strong>: decreasing the frequency of your data, such as from hours to days
Both methods require you to invent data, since the data points don’t actually exist</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resampling an Entire DataFrame with the Same Method</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Resampling Data with Different Methods</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Close Price&#39;</span><span class="p">:</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span>
    <span class="s1">&#39;High Price&#39;</span><span class="p">:</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Low Price&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Open Price&#39;</span><span class="p">:</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Volume&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
</section>
<section id="apply">
<h2>apply<a class="headerlink" href="#apply" title="Link to this heading">¶</a></h2>
<p>apply works on a row / column basis of a DataFrame</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">eg: df.apply(np.square)</span>

<span class="sd">Apply: It is used when you want to apply a function along the axis of a dataframe</span>
<span class="sd">accepts a Series whose index is either column (axis=0) or row (axis=1)</span>
<span class="sd">apply works on df and series too</span>
<span class="sd">map works on series only &quot;&quot;&quot;</span>

<span class="n">random_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 2 decimal points</span>
<span class="n">dfx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">random_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfx</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">dfx</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># apply needs vectorized function</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dfx</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">))</span>  <span class="c1"># abs makes neg number positive</span>

<span class="c1"># apply requires a vectorized function!</span>
<span class="c1"># def double_if_positive(x):</span>
<span class="c1">#  if x &gt; 0:</span>
<span class="c1">#      return 2 * x  # x here is an array, not a single number!</span>
<span class="c1">#  return x</span>

<span class="k">def</span> <span class="nf">double_if_positive</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># prevents you from mutating x datasource</span>
    <span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># masked array  x[condition]</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">dfx</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">double_if_positive</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># raw=False</span>
<span class="c1"># Panda Series so 1 col at a time, raw=True fast on simple calculations</span>
<span class="c1"># ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</span>
</pre></div>
</div>
</section>
<section id="map-apply-mapapply">
<h2>map apply mapapply<a class="headerlink" href="#map-apply-mapapply" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>map is defined on Series only</p></li>
<li><p>applymap is defined on DataFrames only</p></li>
<li><p>apply is defined on both</p></li>
</ul>
<section id="map">
<h3>map<a class="headerlink" href="#map" title="Link to this heading">¶</a></h3>
<p>map works element-wise on a Series</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># map operates on Series &amp; uses dictionary input not array input</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Steve&quot;</span><span class="p">,</span> <span class="s2">&quot;Alex&quot;</span><span class="p">,</span> <span class="s2">&quot;Jess&quot;</span><span class="p">,</span> <span class="s2">&quot;Mark&quot;</span><span class="p">])</span>
<span class="n">series</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s2">&quot;Steve&quot;</span><span class="p">:</span> <span class="s2">&quot;Stephen&quot;</span><span class="p">})</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">0    Stephen</span>
<span class="sd">1        NaN</span>
<span class="sd">2        NaN</span>
<span class="sd">3        NaN</span>
<span class="sd">dtype: object</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># unlike apply (needs vectorized function) this goes over each element 1 at a time</span>
<span class="n">series</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">fn</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;I am </span><span class="si">{</span><span class="n">fn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="vectorized-functions">
<h3>vectorized functions<a class="headerlink" href="#vectorized-functions" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># https://medium.com/codex/vectorizing-functions-in-numpy-d00dc5e58f65</span>

<span class="n">sky_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Obi-Wan Kenobi&quot;</span><span class="p">,</span> <span class="s2">&quot;Luke Skywalker&quot;</span><span class="p">,</span> <span class="s2">&quot;Han Solo&quot;</span><span class="p">,</span> <span class="s2">&quot;Leia Organa&quot;</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">0 [Obi-Wan, Kenobi]</span>
<span class="sd">1 [Luke, Skywalker]</span>
<span class="sd">2 [Han, Solo]</span>
<span class="sd">3 [Leia, Organa]</span>
<span class="sd">dtype: object</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># user defined functions</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">df_extra1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>

<span class="n">hypot</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_extra1</span><span class="o">.</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">df_extra1</span><span class="o">.</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>

<span class="c1"># non vectorized -&gt; takes 16 seconds</span>
<span class="k">def</span> <span class="nf">hypot_bad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">df_extra1</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">h1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hypot_bad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>


<span class="c1"># vectorized -&gt; quick 13ms</span>
<span class="k">def</span> <span class="nf">hypot_good</span><span class="p">(</span><span class="n">row_of_xs</span><span class="p">,</span> <span class="n">row_of_ys</span><span class="p">):</span>  <span class="c1"># feed it with rows of data not element by element</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">row_of_xs</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">row_of_ys</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">h2</span> <span class="o">=</span> <span class="n">hypot_good</span><span class="p">(</span><span class="n">df_extra1</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df_extra1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="applymap">
<h3>applymap<a class="headerlink" href="#applymap" title="Link to this heading">¶</a></h3>
<p>applymap works element-wise on a DataFrame</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pycoingecko</span> <span class="kn">import</span> <span class="n">CoinGeckoAPI</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.float_format&quot;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">data_btc</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">get_coin_market_chart_by_id</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;bitcoin&quot;</span><span class="p">,</span><span class="n">vs_currency</span><span class="o">=</span><span class="s2">&quot;usd&quot;</span><span class="p">,</span><span class="n">days</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>

<span class="n">btc_history</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_btc</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># ignore elem 0 datetime</span>

<span class="n">btc_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_btc</span><span class="p">)</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">unit</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">btc_dates</span>
</pre></div>
</div>
</section>
<section id="transform">
<h3>transform<a class="headerlink" href="#transform" title="Link to this heading">¶</a></h3>
<p>transform -&gt; like apply but has to return a series with same size as the input
<a class="reference external" href="https://stackoverflow.com/questions/27517425/apply-vs-transform-on-a-group-object">read more</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># instead of NaN fill with mean value of the series</span>
<span class="n">test_fix</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Sales</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
</section>
</section>
<section id="id2">
<h2>aggregate<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># sales are heavily dependant on day of the week, so use that intelligence with groupby cuts</span>

<span class="c1"># different aggregates for different columns</span>
<span class="c1"># aggregate statistics functions can be used to calc stats on a column of a DataFrame Eg df.columnName.mean()</span>
<span class="c1"># aggregate statistic functions can be applied across multiple rows by using a groupby function</span>
<span class="c1"># give the mean for the Sales &amp; Customers column</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">,</span> <span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;Customers&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">})</span>  <span class="c1"># str for common funcs works too</span>

<span class="c1"># do multiple things with 1 column (pass multiple things through a list)</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">,</span> <span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">],</span> <span class="s2">&quot;Customers&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                          Sales              Customers</span>
<span class="sd">                           mean    max   min     count</span>
<span class="sd">   Store DayOfWeek</span>
<span class="sd">   1     1          5177.968750   9528  3414       128</span>
<span class="sd">         2          4685.626866   7959  2362       134</span>
<span class="sd">         3          4555.712121   7821  2605       132</span>
<span class="sd">         4          4457.838710   7785  2462       124</span>
<span class="sd">         5          4726.480620   8414  3198       129</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">monte_carlo_uncertainty</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">,</span> <span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">monte_carlo_uncertainty</span><span class="p">],</span> <span class="s2">&quot;Customers&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>
<span class="n">df2</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">               		Sales             Customers</span>
<span class="sd">                           mean  &lt;lambda_0&gt;     count</span>
<span class="sd">   Store DayOfWeek</span>
<span class="sd">   1     1          5177.968750  108.777349       128</span>
<span class="sd">         2          4685.626866   88.507530       134</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<section id="override-column-names-using-tuple">
<h3>override column names using tuple<a class="headerlink" href="#override-column-names-using-tuple" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">,</span> <span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="p">{</span>
      <span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;SalesMean&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">),</span>
	        <span class="p">(</span><span class="s2">&quot;SalesUncert&quot;</span><span class="p">,</span> <span class="n">monte_carlo_uncertainty</span><span class="p">)</span>
	       <span class="p">],</span>
      <span class="s2">&quot;Customers&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span>
    <span class="p">})</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># notice the nested multi-column layout</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Sales             Customers</span>
<span class="sd">                      SalesMean SalesUncert     count</span>
<span class="sd">   Store DayOfWeek</span>
<span class="sd">   1     1          5177.968750  108.777349       128</span>
<span class="sd">         2          4685.626866   88.507530       134</span>
<span class="sd">         3          4555.712121   79.957721       132</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># new way of using aggregates (recommended) won&#39;t work with lambda as all functions need to have a name</span>
<span class="c1"># =&gt; only 1 layer of columns</span>
<span class="k">def</span> <span class="nf">mc_uncert</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">dfagg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Store&quot;</span><span class="p">,</span> <span class="s2">&quot;DayOfWeek&quot;</span><span class="p">])</span>
<span class="n">dfagg</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
       <span class="n">SalesMean</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">),</span>
       <span class="n">SalesUncert</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span> <span class="n">mc_uncert</span><span class="p">)</span>
   <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Store  DayOfWeek    SalesMean  SalesUncert</span>
<span class="sd">   0      1          1  5177.968750   108.777349</span>
<span class="sd">   1      1          2  4685.626866    88.507530</span>
<span class="sd">   2      1          3  4555.712121    79.957721</span>
<span class="sd">   3      1          4  4457.838710    82.332880</span>
<span class="sd">   4      1          5  4726.480620    80.066588</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="configure-options">
<h2>configure options<a class="headerlink" href="#configure-options" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3>pandas<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">describe_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>  <span class="c1"># default = 60</span>
<span class="n">pd</span><span class="o">.</span><span class="n">describe_option</span><span class="p">(</span><span class="s2">&quot;max_col&quot;</span><span class="p">)</span> <span class="c1"># get info on display.max_columns &amp; max_colwidth</span>

<span class="n">pd</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="c1"># same as</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="c1"># 60</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">6</span>
<span class="c1"># reset</span>
<span class="n">pd</span><span class="o">.</span><span class="n">reset_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">)</span>
<span class="c1"># precision floats</span>
<span class="n">pd</span><span class="o">.</span><span class="n">describe_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">pd</span><span class="o">.</span><span class="n">describe_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">)</span> 
<span class="c1"># only print if value &gt;= 0.25 otherwise print 0</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.chop_threshold&quot;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># settings for one cell</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span>
	<span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
	<span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
	<span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">3</span>
<span class="p">):</span>
	<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># notebook function display</span>
</pre></div>
</div>
</section>
<section id="ipython">
<h3>ipython<a class="headerlink" href="#ipython" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_colwidth</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">HTML</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">escape</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>



<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.float_format&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;panel_data.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="optimize-memory-usage">
<h2>optimize memory usage<a class="headerlink" href="#optimize-memory-usage" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to category where you can, check with nunique()</span>
<span class="n">employees</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">employees</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="string-manipulations">
<h2>string manipulations<a class="headerlink" href="#string-manipulations" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove whitespace around text</span>
<span class="n">employees</span><span class="p">[</span><span class="s2">&quot;First Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">inspections</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
	<span class="n">inspections</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">inspections</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="nb">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>  <span class="c1"># cap first letter</span>
<span class="nb">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="c1"># caps first letter of each word (countries names cities locations)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace text</span>
<span class="n">inspections</span> <span class="o">=</span> <span class="n">inspections</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="s2">&quot;All&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Risk 4 (Extreme)&quot;</span><span class="p">)</span>
<span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Risk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">High)</span>
<span class="sd">Medium)</span>
<span class="sd">Low)</span>
<span class="sd">High)</span>
<span class="sd">High)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># regex replace digits with an asterisk</span>
<span class="c1"># 0  	1256 Trace Ports Apt. 419</span>
<span class="n">customers</span><span class="p">[</span><span class="s2">&quot;Street&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;\d{4,}&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Risk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># remove ) too</span>
<span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Risk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># remove ) too</span>
<span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;pizza&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># consistency w lower first</span>
<span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;tacos&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">inspections</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;tacos&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># expand=True returns dataframe</span>
<span class="n">customers</span><span class="p">[</span><span class="s2">&quot;Address&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># adjust what should be used as column index &amp; header</span>
<span class="c1"># eg here state,city,street = multiIndex tuple</span>
<span class="c1"># Category cols service or culture</span>
<span class="n">neighborhoods</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;nbs.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># to get city</span>
<span class="n">neighborhoods</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">neighborhoods</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;City&quot;</span><span class="p">)</span>

<span class="c1"># name multi index column index:</span>
<span class="n">neighborhoods</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">,</span> <span class="s2">&quot;Subcategory&quot;</span><span class="p">]</span>
<span class="n">neighborhoods</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">neighborhoods</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;Category&quot;</span><span class="p">)</span>
<span class="c1"># Index([&#39;Culture&#39;,&#39;Culture&#39;,&#39;Services&#39;,&#39;Services&#39;],dtype=&#39;object&#39;, name=&#39;Category&#39;)</span>
</pre></div>
</div>
</section>
<section id="reshaping-pivoting">
<h2>reshaping &amp; pivoting<a class="headerlink" href="#reshaping-pivoting" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use Date column as pivot, calc mean with aggfunc param</span>
<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>

<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>

<span class="c1"># onlu sum up Revenue values</span>
<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Revenue&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>

<span class="c1"># revenue per salesman, replace NaN with 0</span>
<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Revenue&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># name      	Creed	Jim	   Bart</span>
<span class="c1"># Date</span>
<span class="c1"># 2021-01-01	4444    1234   3456</span>
<span class="c1"># 2021-01-01	   0    5434   1456</span>

<span class="c1"># date + salesman subtotal margins=True (add totals for each row and column)</span>
<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Revenue&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span>
	<span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span>

<span class="c1"># aggfunc=&quot;count&quot; count no of sales rows for each Date x Employee</span>

<span class="c1"># max, min, std, median, size (same as count)</span>
<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
	<span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
	<span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
	<span class="n">values</span><span class="o">=</span><span class="s2">&quot;Revenue&quot;</span><span class="p">,</span>
	<span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
	<span class="n">aggfunc</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">]</span>
	<span class="p">)</span>

<span class="n">sales</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
	<span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span>
	<span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
	<span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;Expenses&quot;</span><span class="p">],</span>
	<span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
	<span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Revenue&quot;</span><span class="p">:</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;Expenses&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
	<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="un-stack-melt-explode">
<h2>(un)stack melt explode<a class="headerlink" href="#un-stack-melt-explode" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># move date from column axis to row axis</span>
<span class="n">df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="c1"># row to col axis</span>
<span class="n">df</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

<span class="c1"># melting = wide data set -&gt; narrow data set</span>
<span class="n">video_game_sales</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

<span class="n">regional_sales_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NA&quot;</span><span class="p">,</span> <span class="s2">&quot;EU&quot;</span><span class="p">,</span> <span class="s2">&quot;JP&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]</span>
<span class="n">video_game_sales</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="n">regional_sales_columns</span><span class="p">)</span>

<span class="c1"># explode a list of walues</span>
<span class="n">recipes</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;Ingredients&quot;</span><span class="p">)</span> <span class="c1"># requires a Series of Lists</span>
</pre></div>
</div>
</section>
<section id="importing-exporting">
<h2>importing/exporting<a class="headerlink" href="#importing-exporting" title="Link to this heading">¶</a></h2>
<section id="json">
<h3>json<a class="headerlink" href="#json" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># importing json</span>
<span class="n">nobel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;nobel.json&quot;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">chemistry_2019</span><span class="p">)</span> <span class="c1"># still dicts in laureates</span>
<span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">chemistry_2019</span><span class="p">,</span> <span class="n">record_path</span><span class="o">=</span><span class="s2">&quot;laureates&quot;</span><span class="p">)</span> <span class="c1"># norm this column</span>

<span class="c1"># preserve year &amp; category columns!</span>
<span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">chemistry_2019</span><span class="p">,</span>
	<span class="n">record_path</span><span class="o">=</span><span class="s2">&quot;laureates&quot;</span><span class="p">,</span>
	<span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">])</span>

<span class="c1"># add key, value if key doesn&#39;t exist</span>
<span class="n">cheese_consumption</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;France&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># if no laureates key exist, add one (= no error at importing)</span>
<span class="k">def</span> <span class="nf">add_laureates_key</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
	<span class="n">entry</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;laureates&quot;</span><span class="p">,</span> <span class="p">[])</span>

<span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;prizes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">add_laureates_key</span><span class="p">)</span>

<span class="n">winners</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span>
	<span class="n">data</span><span class="o">=</span><span class="n">nobel</span><span class="p">[</span><span class="s2">&quot;prizes&quot;</span><span class="p">],</span>
	<span class="n">record_path</span><span class="o">=</span><span class="s2">&quot;laureates&quot;</span><span class="p">,</span>
	<span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">]</span>
	<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># exporting json</span>
<span class="n">winners</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span> <span class="c1"># json arr of k,v objects</span>
<span class="n">winners</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;split&quot;</span><span class="p">)</span> <span class="c1"># seperate column, index &amp; data keys</span>
<span class="c1"># other orient options: index, columns, values, table</span>
<span class="n">winners</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;winners.json&quot;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span> <span class="c1"># will overwrite!</span>

<span class="c1"># save you from dld manually</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://data.nyc.us/api/views/345345/rows.csv&quot;</span>
<span class="n">baby_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">baby_names</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/baby_names.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># only these columns</span>
<span class="n">baby_names</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/baby_names.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
		<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span> <span class="s2">&quot;Child&#39;s First Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="read-excel-workbooks">
<h3>read excel workbooks<a class="headerlink" href="#read-excel-workbooks" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># install xlrd and openpyxl libs</span>
<span class="n">conda</span> <span class="n">install</span> <span class="n">xlrd</span> <span class="n">openpyxl</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Single Worksheet.xlsx&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
	<span class="n">io</span><span class="o">=</span><span class="s2">&quot;Single Worksheet.xlsx&quot;</span><span class="p">,</span>
	<span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;City&quot;</span><span class="p">,</span> <span class="s2">&quot;First Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last Name&quot;</span><span class="p">],</span>
	<span class="n">index_col</span> <span class="o">=</span> <span class="s2">&quot;City&quot;</span>
	<span class="p">)</span>

<span class="c1"># squeeze=True to force a series object</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Multiple Worksheets.xlsx&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># first worksheet</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Multiple Worksheets.xlsx&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Data 1&quot;</span><span class="p">)</span>

<span class="c1"># import all worksheets</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Multiple Worksheets.xlsx&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># each sheet = a df</span>
<span class="n">workbook</span><span class="p">[</span><span class="s2">&quot;Data 2&quot;</span><span class="p">]</span>

<span class="c1"># specified worksheet only</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Multiple Worksheets.xlsx&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Data 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Data 3&quot;</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Multiple Worksheets.xlsx&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="exporting-excel-workbook">
<h3>exporting excel workbook<a class="headerlink" href="#exporting-excel-workbook" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create ExcelWriter object</span>
<span class="n">excel_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s2">&quot;data/BabyNames.xlsx&quot;</span><span class="p">)</span>
<span class="n">boys</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span>
	<span class="n">excel_writer</span><span class="o">=</span><span class="n">excel_file</span><span class="p">,</span>
	<span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Boys&quot;</span><span class="p">,</span>
	<span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># exclude df&#39;s index</span>
	<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Child&#39;s First Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="s2">&quot;Rank&quot;</span><span class="p">]</span>
	<span class="p">)</span>
<span class="n">excel_file</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="pyarrow">
<h2>pyarrow<a class="headerlink" href="#pyarrow" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;foobar&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string[pyarrow]&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">dtype_backend</span> <span class="o">=</span> <span class="s2">&quot;pyarrow&quot;</span>  <span class="c1"># srting = string &amp; niet object</span>

<span class="c1"># pyarrow is good at handling missing values</span>
<span class="c1"># None doesn&#39;t turn int64 into a float dtype, None become &lt;NA&gt; instead of NaN</span>
<span class="n">df_arrow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;names.csv&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;pyarrow&quot;</span><span class="p">,</span> <span class="n">use_nullable_dtypes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">main</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sphinx.html">sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash/index.html">bash</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="assert.html">assert python</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio.html">asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">itertools</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html#collections">collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataclass.html">dataclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="decorators.html">decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="designpatterns.html">design patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_ops.html">glob</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html">functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="generator.html">generators</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="regex.html">regex</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">pytest</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">code library</a></li>
</ul>
</li>
</ul>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">pandas</a><ul>
<li><a class="reference internal" href="#get-df-info">get df info</a></li>
<li><a class="reference internal" href="#calculations">calculations</a></li>
<li><a class="reference internal" href="#plotting">plotting</a><ul>
<li><a class="reference internal" href="#pyplot">pyplot</a></li>
<li><a class="reference internal" href="#seaborn">seaborn</a></li>
</ul>
</li>
<li><a class="reference internal" href="#renaming-and-dropping-columns">renaming and dropping columns</a><ul>
<li><a class="reference internal" href="#rename-column">rename column</a></li>
<li><a class="reference internal" href="#drop-column">drop column</a></li>
<li><a class="reference internal" href="#rename-index">rename index</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sorting">sorting</a><ul>
<li><a class="reference internal" href="#sort-values">sort_values</a></li>
<li><a class="reference internal" href="#rank">rank</a></li>
</ul>
</li>
<li><a class="reference internal" href="#filtering">filtering</a><ul>
<li><a class="reference internal" href="#mask-helpers">mask helpers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#groupby">groupby</a><ul>
<li><a class="reference internal" href="#aggregate">aggregate</a></li>
<li><a class="reference internal" href="#multiple-groups">multiple groups</a></li>
<li><a class="reference internal" href="#binning">binning</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merge-concatenate">merge &amp; concatenate</a><ul>
<li><a class="reference internal" href="#concat">concat</a></li>
<li><a class="reference internal" href="#merge">merge</a><ul>
<li><a class="reference internal" href="#left-outer-join">left (outer) join</a></li>
<li><a class="reference internal" href="#inner-join">inner join</a></li>
<li><a class="reference internal" href="#id1">concat</a></li>
<li><a class="reference internal" href="#summary">summary</a></li>
<li><a class="reference internal" href="#full-outer-join">full outer join</a></li>
<li><a class="reference internal" href="#duplicate-keys">duplicate keys</a></li>
<li><a class="reference internal" href="#duplicate-columns">duplicate columns</a></li>
<li><a class="reference internal" href="#validating">validating</a></li>
<li><a class="reference internal" href="#merge-indicator">merge indicator</a></li>
<li><a class="reference internal" href="#composite-keys">composite keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merge-helper-functions">merge helper functions</a><ul>
<li><a class="reference internal" href="#pd-merge-ordered">pd.merge_ordered</a></li>
<li><a class="reference internal" href="#pd-merge-asof">pd.merge_asof</a></li>
<li><a class="reference internal" href="#tolerance">tolerance</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#missing-values">missing values</a><ul>
<li><a class="reference internal" href="#isna-notna">isna notna</a></li>
<li><a class="reference internal" href="#dropna">dropna</a></li>
<li><a class="reference internal" href="#isnull-notnull">isnull notnull</a></li>
<li><a class="reference internal" href="#fillna">fillna</a></li>
</ul>
</li>
<li><a class="reference internal" href="#duplicates">duplicates</a></li>
<li><a class="reference internal" href="#replace">replace</a></li>
<li><a class="reference internal" href="#tresholding-outliers">tresholding (outliers)</a></li>
<li><a class="reference internal" href="#dtype-conversion">dtype conversion</a><ul>
<li><a class="reference internal" href="#to-int">to int</a></li>
<li><a class="reference internal" href="#to-categorical">to categorical</a></li>
</ul>
</li>
<li><a class="reference internal" href="#timeseries">timeseries</a><ul>
<li><a class="reference internal" href="#timestamp">timestamp</a></li>
<li><a class="reference internal" href="#datetimeindex">datetimeindex</a></li>
<li><a class="reference internal" href="#to-datetime">to datetime</a></li>
<li><a class="reference internal" href="#using-dt-object">using dt object</a></li>
<li><a class="reference internal" href="#date-offsetting">date offsetting</a></li>
<li><a class="reference internal" href="#timedelta">timedelta</a></li>
<li><a class="reference internal" href="#datetime-filtering">datetime filtering</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resample">resample</a></li>
<li><a class="reference internal" href="#apply">apply</a></li>
<li><a class="reference internal" href="#map-apply-mapapply">map apply mapapply</a><ul>
<li><a class="reference internal" href="#map">map</a></li>
<li><a class="reference internal" href="#vectorized-functions">vectorized functions</a></li>
<li><a class="reference internal" href="#applymap">applymap</a></li>
<li><a class="reference internal" href="#transform">transform</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">aggregate</a><ul>
<li><a class="reference internal" href="#override-column-names-using-tuple">override column names using tuple</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-options">configure options</a><ul>
<li><a class="reference internal" href="#id3">pandas</a></li>
<li><a class="reference internal" href="#ipython">ipython</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimize-memory-usage">optimize memory usage</a></li>
<li><a class="reference internal" href="#string-manipulations">string manipulations</a></li>
<li><a class="reference internal" href="#reshaping-pivoting">reshaping &amp; pivoting</a></li>
<li><a class="reference internal" href="#un-stack-melt-explode">(un)stack melt explode</a></li>
<li><a class="reference internal" href="#importing-exporting">importing/exporting</a><ul>
<li><a class="reference internal" href="#json">json</a></li>
<li><a class="reference internal" href="#read-excel-workbooks">read excel workbooks</a></li>
<li><a class="reference internal" href="#exporting-excel-workbook">exporting excel workbook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyarrow">pyarrow</a></li>
</ul>
</li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="regex.html" title="regex"
             >next</a> |</li>
        <li class="right" >
          <a href="generator.html" title="generators"
             >previous</a> |</li>
          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="../index.html">PowrUsr Docs alpha documentation</a> &#187;
              
          </li>
          <li class="nav-item nav-item-1"><a href="index.html" >python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pandas</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; Copyright 2023, PowrUsr.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Last updated on 2023-12-18.
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>

  </body>
</html>