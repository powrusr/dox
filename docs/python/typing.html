<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>typing &#8212; PowrUsr Docs alpha documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=aa5eeaf2" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=b20cc3f5" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c6eb1e0f" />
    
    <script src="../_static/documentation_options.js?v=1f169f65"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="code library" href="examples.html" />
    <link rel="prev" title="pytest" href="testing.html" /><link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">main</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ai/index.html">ai</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sphinx.html">sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash/index.html">bash</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="assert.html">assert</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio.html">asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">core</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataclass.html">dataclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataclass.html#attrs">Attrs</a></li>
<li class="toctree-l2"><a class="reference internal" href="designpatterns.html">design patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_ops.html">glob</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html">functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="pandas.html">pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyenv.html">pyenv</a></li>
<li class="toctree-l2"><a class="reference internal" href="regex.html">regex</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">pytest</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#annotated-typing">annotated typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pydantic">pydantic</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">code library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vim/index.html">vim</a></li>
</ul>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">typing</a><ul>
<li><a class="reference internal" href="#use-abcs-for-typing">use ABCs for typing</a></li>
<li><a class="reference internal" href="#enums">enums</a><ul>
<li><a class="reference internal" href="#auto">auto</a><ul>
<li><a class="reference internal" href="#overriding-auto">overriding auto</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#functions">functions</a></li>
<li><a class="reference internal" href="#classes">classes</a></li>
<li><a class="reference internal" href="#duck-types">duck types</a></li>
<li><a class="reference internal" href="#asyncs">asyncs</a><ul>
<li><a class="reference internal" href="#async-iterators">async iterators</a></li>
<li><a class="reference internal" href="#async-generators">async generators</a></li>
<li><a class="reference internal" href="#gotchas">gotchas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#type-aliases">type aliases</a></li>
<li><a class="reference internal" href="#newtype">NewType</a></li>
<li><a class="reference internal" href="#annotating-callables">annotating callables</a><ul>
<li><a class="reference internal" href="#ellepsis">ellepsis …</a></li>
</ul>
</li>
<li><a class="reference internal" href="#abcs">ABCs</a></li>
<li><a class="reference internal" href="#generics">generics</a></li>
<li><a class="reference internal" href="#override">override</a></li>
<li><a class="reference internal" href="#typeddict-kwargs">TypedDict &amp; **kwargs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#annotated-typing">annotated typing</a></li>
<li><a class="reference internal" href="#pydantic">pydantic</a><ul>
<li><a class="reference internal" href="#types">types</a><ul>
<li><a class="reference internal" href="#annotated">annotated</a></li>
<li><a class="reference internal" href="#typeadapter">TypeAdapter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deserialize">deserialize</a><ul>
<li><a class="reference internal" href="#from-dict">from dict</a></li>
<li><a class="reference internal" href="#from-json">from json</a></li>
</ul>
</li>
<li><a class="reference internal" href="#serialize">serialize</a><ul>
<li><a class="reference internal" href="#custom-serializer">custom serializer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fields">fields</a><ul>
<li><a class="reference internal" href="#alias">alias</a></li>
<li><a class="reference internal" href="#allow-not-using-alias">allow not using alias</a></li>
<li><a class="reference internal" href="#defaults">defaults</a><ul>
<li><a class="reference internal" href="#mutable-defaults">mutable defaults</a></li>
<li><a class="reference internal" href="#default-factory">default factory</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#validation">validation</a><ul>
<li><a class="reference internal" href="#custom-validators">custom validators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nested-models">nested models</a></li>
<li><a class="reference internal" href="#validate-call">validate call</a></li>
<li><a class="reference internal" href="#real-world-example">real world example</a></li>
</ul>
</li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </nav>
    </div>
</div>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="examples.html" title="code library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="pytest"
             accesskey="P">previous</a> |</li>
          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="../index.html">PowrUsr Docs alpha documentation</a> &#187;
              
          </li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">typing</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="typing">
<h1>typing<a class="headerlink" href="#typing" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://docs.python.org/3/library/typing.html">official docs</a>
<a class="reference external" href="https://typing.readthedocs.io/en/latest/">community docs</a>
<a class="reference external" href="https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html">cheatsheet</a></p>
<section id="use-abcs-for-typing">
<h2>use ABCs for typing<a class="headerlink" href="#use-abcs-for-typing" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes">all ABCs</a></p>
<p>using ABC’s allow for more generic typing
see above link with table to see wich ABC you need</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Collection</span>


<span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="n">numbers</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># credit to mCoding</span>
<span class="c1"># https://github.com/mCodingLLC/VideosSampleCode/blob/master/videos/124_abc_collections/main.py</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">,</span> <span class="n">Mapping</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span>

<span class="n">KT</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;KT&#39;</span><span class="p">)</span>
<span class="n">VT</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;VT&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">InvertibleDict</span><span class="p">(</span><span class="n">MutableMapping</span><span class="p">[</span><span class="n">KT</span><span class="p">,</span> <span class="n">VT</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A invertible (one-to-one) mapping.</span>

<span class="sd">    Attempting to set multiple keys to the same value will raise a ValueError.</span>

<span class="sd">    invariant: _forward and _backward are mathematical inverses</span>
<span class="sd">        i.e. _forward[a] == b if and only if _backward[b] == a</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_forward&#39;</span><span class="p">,</span> <span class="s1">&#39;_backward&#39;</span><span class="p">)</span>

    <span class="n">_forward</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">KT</span><span class="p">,</span> <span class="n">VT</span><span class="p">]</span>
    <span class="n">_backward</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">VT</span><span class="p">,</span> <span class="n">KT</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">forward</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">KT</span><span class="p">,</span> <span class="n">VT</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
            <span class="n">_backward</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">VT</span><span class="p">,</span> <span class="n">KT</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">forward</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># empty init</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">elif</span> <span class="n">_backward</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># inverse init (private)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span> <span class="o">=</span> <span class="n">forward</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="n">_backward</span>  <span class="c1"># private param, assume correct</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># user-provided forward init</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span> <span class="o">=</span> <span class="n">forward</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="p">:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_non_invertible</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_check_non_invertible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">other_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">other_key</span> <span class="o">!=</span> <span class="n">key</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_non_invertible</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">other_key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_raise_non_invertible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key1</span><span class="p">:</span> <span class="n">KT</span><span class="p">,</span> <span class="n">key2</span><span class="p">:</span> <span class="n">KT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">VT</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;non-invertible: </span><span class="si">{</span><span class="n">key1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">key2</span><span class="si">}</span><span class="s2"> both map to: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InvertibleDict</span><span class="p">[</span><span class="n">VT</span><span class="p">,</span> <span class="n">KT</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A mutable view of the inverse dict.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="p">,</span> <span class="n">_backward</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">KT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VT</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">KT</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">VT</span><span class="p">):</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
        <span class="n">old_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">missing</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">old_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">missing</span> <span class="ow">and</span> <span class="n">old_key</span> <span class="o">!=</span> <span class="n">key</span><span class="p">:</span>  <span class="c1"># {1: &quot;a&quot;} -&gt; {1: &quot;a&quot;, 2: &quot;a&quot;}</span>
            <span class="c1"># value is already mapped to a different key</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raise_non_invertible</span><span class="p">(</span><span class="n">old_key</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">old_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">missing</span><span class="p">)</span>  <span class="c1"># {1: &quot;a&quot;}/{&quot;a&quot;: 1} -&gt; {1: &quot;b&quot;}/{&quot;b&quot;: 1}</span>
        <span class="k">if</span> <span class="n">old_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">missing</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="p">[</span><span class="n">old_value</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">KT</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="si">!r}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_forward</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backward</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">basic_usage_example</span><span class="p">():</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">InvertibleDict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">inv</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">fn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span>
    <span class="k">assert</span> <span class="n">fn</span><span class="o">.</span><span class="n">inv</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="n">fn</span><span class="o">.</span><span class="n">inv</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">assert</span> <span class="n">fn</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span>
    <span class="k">assert</span> <span class="n">fn</span><span class="o">.</span><span class="n">inv</span><span class="p">[</span><span class="s2">&quot;d&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">inv</span><span class="p">)</span>

    <span class="c1"># fn[4] = &quot;a&quot; # ValueError</span>
    <span class="c1"># InvertibleDict({1: &quot;a&quot;, 2: &quot;a&quot;}) # ValueError</span>
    <span class="c1"># fn = InvertibleDict({1: []}) # TypeError, need hashable values</span>


<span class="k">def</span> <span class="nf">delete_min_key</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">MutableMapping</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">delete_min_example</span><span class="p">():</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">InvertibleDict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="n">delete_min_key</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="n">delete_min_key</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">inv</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isinstance_example</span><span class="p">():</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">InvertibleDict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">})</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">InvertibleDict</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">FakeMutableMapping</span><span class="p">(),</span> <span class="n">MutableMapping</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">FakeMutableMapping</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">deep_min</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">deep_min</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">deep_min</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">d</span>


<span class="k">class</span> <span class="nc">MyMapping</span><span class="p">:</span>
    <span class="o">...</span>


<span class="n">Mapping</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyMapping</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">deep_min_example</span><span class="p">():</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">InvertibleDict</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}),</span>
                         <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">}),</span>
                         <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">})})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">deep_min</span><span class="p">(</span><span class="n">fn</span><span class="p">))</span>
    <span class="k">assert</span> <span class="n">deep_min</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">basic_usage_example</span><span class="p">()</span>
    <span class="n">isinstance_example</span><span class="p">()</span>
    <span class="n">delete_min_example</span><span class="p">()</span>
    <span class="n">deep_min_example</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="enums">
<h2>enums<a class="headerlink" href="#enums" title="Link to this heading">¶</a></h2>
<section id="auto">
<h3>auto<a class="headerlink" href="#auto" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>


<span class="k">class</span> <span class="nc">State</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">PENDING</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">FULFILLED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">REJECTED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">State</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">PENDING 1</span>
<span class="go">FULFILLED 2</span>
<span class="go">REJECTED 3</span>
</pre></div>
</div>
<p>an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>


<span class="k">class</span> <span class="nc">MessageType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">SWITCH_ON</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">SWITCH_OFF</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">CHANGE_COLOR</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">PLAY_SONG</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">OPEN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">CLOSE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Message</span><span class="p">:</span>
    <span class="n">device_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">msg_type</span><span class="p">:</span> <span class="n">MessageType</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<section id="overriding-auto">
<h4>overriding auto<a class="headerlink" href="#overriding-auto" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">_generate_next_value_(name,</span> <span class="pre">start,</span> <span class="pre">count,</span> <span class="pre">last_values)</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>


<span class="k">class</span> <span class="nc">State</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_generate_next_value_</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">last_values</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="n">PENDING</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">FULFILLED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="n">REJECTED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>


<span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">State</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">PENDING pending</span>
<span class="go">FULFILLED fulfilled</span>
<span class="go">REJECTED rejected</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="functions">
<h2>functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span>

<span class="c1"># This is how you annotate a function definition</span>
<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

<span class="c1"># And here&#39;s how you specify multiple arguments</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">num1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span>

<span class="c1"># If a function does not return a value, use None as the return type</span>
<span class="c1"># Default value for an argument goes after the type annotation</span>
<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">excitement</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span> <span class="o">*</span> <span class="n">excitement</span><span class="p">)</span>

<span class="c1"># Note that arguments without a type are dynamically typed (treated as Any)</span>
<span class="c1"># and that functions without any annotations are not checked</span>
<span class="k">def</span> <span class="nf">untyped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">anything</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="s2">&quot;string&quot;</span>  <span class="c1"># no errors</span>

<span class="c1"># This is how you annotate a callable (function) value</span>
<span class="n">x</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

<span class="c1"># A generator function that yields ints is secretly just a function that</span>
<span class="c1"># returns an iterator of ints, so that&#39;s how we annotate it</span>
<span class="k">def</span> <span class="nf">gen</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># You can of course split a function annotation over multiple lines</span>
<span class="k">def</span> <span class="nf">send_email</span><span class="p">(</span><span class="n">address</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
               <span class="n">sender</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
               <span class="n">cc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
               <span class="n">bcc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
               <span class="n">subject</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
               <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
               <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="o">...</span>

<span class="c1"># Mypy understands positional-only and keyword-only arguments</span>
<span class="c1"># Positional-only arguments can also be marked by using a name starting with</span>
<span class="c1"># two underscores</span>
<span class="k">def</span> <span class="nf">quux</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">quux</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Ok</span>
<span class="n">quux</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># error: Too many positional arguments for &quot;quux&quot;</span>
<span class="n">quux</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># error: Unexpected keyword argument &quot;x&quot; for &quot;quux&quot;</span>

<span class="c1"># This says each positional arg and each keyword arg is a &quot;str&quot;</span>
<span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># Revealed type is &quot;tuple[str, ...]&quot;</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># Revealed type is &quot;dict[str, str]&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">make_request</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_api_query</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="classes">
<h2>classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BankAccount</span><span class="p">:</span>
    <span class="c1"># The &quot;__init__&quot; method doesn&#39;t return anything, so it gets return</span>
    <span class="c1"># type &quot;None&quot; just like any other method that doesn&#39;t return anything</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">initial_balance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># mypy will infer the correct types for these instance variables</span>
        <span class="c1"># based on the types of the parameters.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">account_name</span> <span class="o">=</span> <span class="n">account_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">initial_balance</span>

    <span class="c1"># For instance methods, omit type for &quot;self&quot;</span>
    <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+=</span> <span class="n">amount</span>

    <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-=</span> <span class="n">amount</span>

<span class="c1"># User-defined classes are valid as types in annotations</span>
<span class="n">account</span><span class="p">:</span> <span class="n">BankAccount</span> <span class="o">=</span> <span class="n">BankAccount</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">BankAccount</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">BankAccount</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">src</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>

<span class="c1"># Functions that accept BankAccount also accept any subclass of BankAccount!</span>
<span class="k">class</span> <span class="nc">AuditedBankAccount</span><span class="p">(</span><span class="n">BankAccount</span><span class="p">):</span>
    <span class="c1"># You can optionally declare instance variables in the class body</span>
    <span class="n">audit_log</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">initial_balance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">initial_balance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audit_log</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audit_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deposited </span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+=</span> <span class="n">amount</span>

    <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audit_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Withdrew </span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-=</span> <span class="n">amount</span>

<span class="n">audited</span> <span class="o">=</span> <span class="n">AuditedBankAccount</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">transfer</span><span class="p">(</span><span class="n">audited</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># type checks!</span>

<span class="c1"># You can use the ClassVar annotation to declare a class variable</span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">:</span>
    <span class="n">seats</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">passengers</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>

<span class="c1"># If you want dynamic attributes on your class, have it</span>
<span class="c1"># override &quot;__setattr__&quot; or &quot;__getattr__&quot;</span>
<span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="c1"># This will allow assignment to any A.x, if x is the same type as &quot;value&quot;</span>
    <span class="c1"># (use &quot;value: Any&quot; to allow arbitrary types)</span>
    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># This will allow access to any A.x, if x is compatible with the return type</span>
    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

<span class="n">a</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="mi">42</span>  <span class="c1"># Works</span>
<span class="n">a</span><span class="o">.</span><span class="n">bar</span> <span class="o">=</span> <span class="s1">&#39;Ex-parrot&#39;</span>  <span class="c1"># Fails type checking</span>
</pre></div>
</div>
</section>
<section id="duck-types">
<h2>duck types<a class="headerlink" href="#duck-types" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">MutableMapping</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Iterable</span>

<span class="c1"># Use Iterable for generic iterables (anything usable in &quot;for&quot;),</span>
<span class="c1"># and Sequence where a sequence (supporting &quot;len&quot; and &quot;__getitem__&quot;) is</span>
<span class="c1"># required</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">ints</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ints</span><span class="p">]</span>

<span class="n">f</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Mapping describes a dict-like object (with &quot;__getitem__&quot;) that we won&#39;t</span>
<span class="c1"># mutate, and MutableMapping one (with &quot;__setitem__&quot;) that we might</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">my_mapping</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">my_mapping</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;maybe&#39;</span>  <span class="c1"># mypy will complain about this line...</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">my_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="n">f</span><span class="p">({</span><span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">my_mapping</span><span class="p">:</span> <span class="n">MutableMapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="n">my_mapping</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;maybe&#39;</span>  <span class="c1"># ...but mypy is OK with this.</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">my_mapping</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="n">f</span><span class="p">({</span><span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">})</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">IO</span>

<span class="c1"># Use IO[str] or IO[bytes] for functions that should accept or return</span>
<span class="c1"># objects that come from an open() call (note that IO does not</span>
<span class="c1"># distinguish between reading, writing or other modes)</span>
<span class="k">def</span> <span class="nf">get_sys_IO</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;w&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
</pre></div>
</div>
</section>
<section id="asyncs">
<h2>asyncs<a class="headerlink" href="#asyncs" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://mypy.readthedocs.io/en/stable/more_types.html#async-and-await">asyncs typing</a></p>
<section id="async-iterators">
<h3>async iterators<a class="headerlink" href="#async-iterators" title="Link to this heading">¶</a></h3>
<p>Asynchronous iterators</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">AsyncIterator</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">class</span> <span class="nc">arange</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="n">step</span>

    <span class="k">def</span> <span class="fm">__aiter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__anext__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StopAsyncIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">run_countdown</span><span class="p">(</span><span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">countdown</span><span class="p">:</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">countdown</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;T-minus </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Blastoff!&quot;</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_countdown</span><span class="p">(</span><span class="s2">&quot;Serenity&quot;</span><span class="p">,</span> <span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</section>
<section id="async-generators">
<h3>async generators<a class="headerlink" href="#async-generators" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">AsyncGenerator</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="c1"># Could also type this as returning AsyncIterator[int]</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">arange</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">start</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="n">stop</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">step</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">current</span> <span class="o">&gt;</span> <span class="n">stop</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">current</span>
        <span class="n">current</span> <span class="o">+=</span> <span class="n">step</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_countdown</span><span class="p">(</span><span class="s2">&quot;Battlestar Galactica&quot;</span><span class="p">,</span> <span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</section>
<section id="gotchas">
<h3>gotchas<a class="headerlink" href="#gotchas" title="Link to this heading">¶</a></h3>
<p>One common confusion is that the presence of a yield statement in an async def function has an effect on the type of the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">AsyncIterator</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">arange</span><span class="p">(</span><span class="n">stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="c1"># When called, arange gives you an async iterator</span>
    <span class="c1"># Equivalent to Callable[[int], AsyncIterator[int]]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">stop</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">coroutine</span><span class="p">(</span><span class="n">stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="c1"># When called, coroutine gives you something you can await to get an async iterator</span>
    <span class="c1"># Equivalent to Callable[[int], Coroutine[Any, Any, AsyncIterator[int]]]</span>
    <span class="k">return</span> <span class="n">arange</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># Revealed type is &quot;typing.AsyncIterator[builtins.int]&quot;</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="n">coroutine</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># Revealed type is &quot;typing.Coroutine[Any, Any, typing.AsyncIterator[builtins.int]]&quot;</span>

    <span class="k">await</span> <span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Error: Incompatible types in &quot;await&quot; (actual type &quot;AsyncIterator[int]&quot;, expected type &quot;Awaitable[Any]&quot;)</span>
    <span class="n">reveal_type</span><span class="p">(</span><span class="k">await</span> <span class="n">coroutine</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># Revealed type is &quot;typing.AsyncIterator[builtins.int]&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="type-aliases">
<h2>type aliases<a class="headerlink" href="#type-aliases" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>

<span class="nb">type</span> <span class="n">ConnectionOptions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="nb">type</span> <span class="n">Address</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="nb">type</span> <span class="n">Server</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Address</span><span class="p">,</span> <span class="n">ConnectionOptions</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">broadcast_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">servers</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Server</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>

<span class="c1"># The static type checker will treat the previous type signature as</span>
<span class="c1"># being exactly equivalent to this one.</span>
<span class="k">def</span> <span class="nf">broadcast_message</span><span class="p">(</span>
        <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">servers</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The type statement is new in Python 3.12. For backwards compatibility, type aliases can also be created through simple assignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Vector</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
<span class="n">Or</span> <span class="n">marked</span> <span class="k">with</span> <span class="n">TypeAlias</span> <span class="n">to</span> <span class="n">make</span> <span class="n">it</span> <span class="n">explicit</span> <span class="n">that</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">a</span> <span class="nb">type</span> <span class="n">alias</span><span class="p">,</span> <span class="ow">not</span> <span class="n">a</span> <span class="n">normal</span> <span class="n">variable</span> <span class="n">assignment</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeAlias</span>

<span class="n">Vector</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="newtype">
<h2>NewType<a class="headerlink" href="#newtype" title="Link to this heading">¶</a></h2>
<p>Use the NewType helper to create distinct types:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NewType</span>

<span class="n">UserId</span> <span class="o">=</span> <span class="n">NewType</span><span class="p">(</span><span class="s2">&quot;UserId&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">some_id</span> <span class="o">=</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">524313</span><span class="p">)</span>
</pre></div>
</div>
<p>The static type checker will treat the new type as if it were a subclass of the original type. This is useful in helping catch logical errors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_user_name</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="n">UserId</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="o">...</span>

<span class="c1"># passes type checking</span>
<span class="n">user_a</span> <span class="o">=</span> <span class="n">get_user_name</span><span class="p">(</span><span class="n">UserId</span><span class="p">(</span><span class="mi">42351</span><span class="p">))</span>

<span class="c1"># fails type checking; an int is not a UserId</span>
<span class="n">user_b</span> <span class="o">=</span> <span class="n">get_user_name</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>You may still perform all int operations on a variable of type UserId, but the result will always be of type int. This lets you pass in a UserId wherever an int might be expected, but will prevent you from accidentally creating a UserId in an invalid way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;output&#39; is of type &#39;int&#39;, not &#39;UserId&#39;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">23413</span><span class="p">)</span> <span class="o">+</span> <span class="n">UserId</span><span class="p">(</span><span class="mi">54341</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="annotating-callables">
<h2>annotating callables<a class="headerlink" href="#annotating-callables" title="Link to this heading">¶</a></h2>
<p>Callable[[int], str] signifies a function that takes a single parameter of type int and returns a str.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Awaitable</span>

<span class="k">def</span> <span class="nf">feeder</span><span class="p">(</span><span class="n">get_next_item</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1"># Body</span>

<span class="k">def</span> <span class="nf">async_query</span><span class="p">(</span><span class="n">on_success</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
                <span class="n">on_error</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1"># Body</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">on_update</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1"># Body</span>

<span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">on_update</span>
</pre></div>
</div>
<section id="ellepsis">
<h3>ellepsis …<a class="headerlink" href="#ellepsis" title="Link to this heading">¶</a></h3>
<p>… means any parameter list is acceptable</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="n">x</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">str</span>     <span class="c1"># OK</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">concat</span>  <span class="c1"># Also OK</span>
</pre></div>
</div>
</section>
</section>
<section id="abcs">
<h2>ABCs<a class="headerlink" href="#abcs" title="Link to this heading">¶</a></h2>
<p>Used in typing so good to have an overview
<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html">abc docs</a></p>
<p>table of collections abstract base classes</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ABC</p></th>
<th class="head"><p>Inherits from</p></th>
<th class="head"><p>Abstract Methods</p></th>
<th class="head"><p>Mixin Methods</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Container</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Hashable</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__hash__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Iterable</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__iter__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Iterator</p></td>
<td><p>Iterable</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__next__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__iter__</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Reversible</p></td>
<td><p>Iterable</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__reversed__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Generator</p></td>
<td><p>Iterator</p></td>
<td><p>send, throw</p></td>
<td><p>close, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, <code class="docutils literal notranslate"><span class="pre">__next__</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sized</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Callable</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__call__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Collection</p></td>
<td><p>Sized, Iterable,<br>Container</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__iter__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Sequence</p></td>
<td><p>Reversible,<br> Collection<br></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, <code class="docutils literal notranslate"><span class="pre">__reversed__</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, and <code class="docutils literal notranslate"><span class="pre">count</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MutableSequence</p></td>
<td><p>Sequence</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__setitem__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__delitem__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__len__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">insert</span></code></p></td>
<td><p>Inherited Sequence methods and append, reverse, extend, pop, remove, and <code class="docutils literal notranslate"><span class="pre">__iadd__</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ByteString</p></td>
<td><p>Sequence</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>,<br><code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
<td><p>Inherited Sequence methods</p></td>
</tr>
<tr class="row-even"><td><p>Set</p></td>
<td><p>Collection</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>,<br> <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>,<br> <code class="docutils literal notranslate"><span class="pre">__len__</span></code><br></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__le__</span></code>, <code class="docutils literal notranslate"><span class="pre">__lt__</span></code>, <code class="docutils literal notranslate"><span class="pre">__eq__</span></code>, <code class="docutils literal notranslate"><span class="pre">__ne__</span></code>, <code class="docutils literal notranslate"><span class="pre">__gt__</span></code>, <code class="docutils literal notranslate"><span class="pre">__ge__</span></code>, <code class="docutils literal notranslate"><span class="pre">__and__</span></code>, <code class="docutils literal notranslate"><span class="pre">__or__</span></code>, <code class="docutils literal notranslate"><span class="pre">__sub__</span></code>, <code class="docutils literal notranslate"><span class="pre">__xor__</span></code>, and <code class="docutils literal notranslate"><span class="pre">isdisjoint</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MutableSet</p></td>
<td><p>Set</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, <code class="docutils literal notranslate"><span class="pre">__len__</span></code>, add, discard	Inherited</p></td>
<td><p>Set methods and <code class="docutils literal notranslate"><span class="pre">clear</span></code>, <code class="docutils literal notranslate"><span class="pre">pop</span></code>, <code class="docutils literal notranslate"><span class="pre">remove</span></code>, <code class="docutils literal notranslate"><span class="pre">__ior__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iand__</span></code>, <code class="docutils literal notranslate"><span class="pre">__ixor__</span></code>, and <code class="docutils literal notranslate"><span class="pre">__isub__</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Mapping</p></td>
<td><p>Collection</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, <code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">keys</span></code>, <code class="docutils literal notranslate"><span class="pre">items</span></code>, <code class="docutils literal notranslate"><span class="pre">values</span></code>, <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">__eq__</span></code>, and <code class="docutils literal notranslate"><span class="pre">__ne__</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>MutableMapping</p></td>
<td><p>Mapping</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">__delitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, <code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
<td><p>Inherited Mapping methods and <code class="docutils literal notranslate"><span class="pre">pop</span></code>, <code class="docutils literal notranslate"><span class="pre">popitem</span></code>, <code class="docutils literal notranslate"><span class="pre">clear</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>, and <code class="docutils literal notranslate"><span class="pre">setdefault</span></code></p></td>
</tr>
<tr class="row-even"><td><p>MappingView</p></td>
<td><p>Sized</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ItemsView</p></td>
<td><p>MappingView, Set</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code></p></td>
</tr>
<tr class="row-even"><td><p>KeysView</p></td>
<td><p>MappingView, Set</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>ValuesView</p></td>
<td><p>MappingView, Collection</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Awaitable</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__await__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Coroutine</p></td>
<td><p>Awaitable</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">send</span></code>, <code class="docutils literal notranslate"><span class="pre">throw</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">close</span></code></p></td>
</tr>
<tr class="row-even"><td><p>AsyncIterable</p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__aiter__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>AsyncIterator</p></td>
<td><p>AsyncIterable</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__anext__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__aiter__</span></code></p></td>
</tr>
<tr class="row-even"><td><p>AsyncGenerator</p></td>
<td><p>AsyncIterator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">asend</span></code>, <code class="docutils literal notranslate"><span class="pre">athrow</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aclose</span></code>, <code class="docutils literal notranslate"><span class="pre">__aiter__</span></code>, <code class="docutils literal notranslate"><span class="pre">__anext__</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Buffer</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">__buffer__</span></code></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="generics">
<h2>generics<a class="headerlink" href="#generics" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="k">class</span> <span class="nc">Employee</span><span class="p">:</span> <span class="o">...</span>

<span class="c1"># Sequence[Employee] indicates that all elements in the sequence</span>
<span class="c1"># must be instances of &quot;Employee&quot;.</span>
<span class="c1"># Mapping[str, str] indicates that all keys and all values in the mapping</span>
<span class="c1"># must be strings.</span>
<span class="k">def</span> <span class="nf">notify_by_email</span><span class="p">(</span><span class="n">employees</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Employee</span><span class="p">],</span>
                    <span class="n">overrides</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Generic functions and classes can be parameterized by using type parameter syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>

<span class="k">def</span> <span class="nf">first</span><span class="p">[</span><span class="n">T</span><span class="p">](</span><span class="n">l</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>  <span class="c1"># Function is generic over the TypeVar &quot;T&quot;</span>
    <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Or by using the TypeVar factory directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span>

<span class="n">U</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>                  <span class="c1"># Declare type variable &quot;U&quot;</span>

<span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="n">l</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">U</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">U</span><span class="p">:</span>  <span class="c1"># Function is generic over the TypeVar &quot;U&quot;</span>
    <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="override">
<h2>override<a class="headerlink" href="#override" title="Link to this heading">¶</a></h2>
<p>Allows our syntax checker to detect when a base class was altered but child classes using it aren’t aware of the change</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Self</span><span class="p">,</span> <span class="n">override</span>


<span class="k">def</span> <span class="nf">generate_account_number</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a random eleven-digit account number&quot;&quot;&quot;</span>
    <span class="n">account_number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10_000_000_000</span><span class="p">,</span> <span class="mi">100_000_000_000</span><span class="p">))</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">account_number</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">account_number</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">account_number</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BankAccount</span><span class="p">:</span>
    <span class="n">account_number</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">balance</span><span class="p">:</span> <span class="nb">float</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_balance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">balance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">generate_account_number</span><span class="p">(),</span> <span class="n">balance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+=</span> <span class="n">amount</span>

    <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-=</span> <span class="n">amount</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SavingsAccount</span><span class="p">(</span><span class="n">BankAccount</span><span class="p">):</span>
    <span class="n">interest</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="nf">add_interest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">interest</span> <span class="o">/</span> <span class="mi">100</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@override</span>  <span class="c1"># track parent class method for changes</span>
    <span class="k">def</span> <span class="nf">from_balance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">balance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">interest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">generate_account_number</span><span class="p">(),</span> <span class="n">balance</span><span class="p">,</span> <span class="n">interest</span><span class="p">)</span>

    <span class="nd">@override</span>
    <span class="k">def</span> <span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="k">else</span> <span class="n">amount</span>
</pre></div>
</div>
</section>
<section id="typeddict-kwargs">
<h2>TypedDict &amp; **kwargs<a class="headerlink" href="#typeddict-kwargs" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Options</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">line_width</span><span class="p">:</span> <span class="nb">int</span>
<span class="gp">... </span>    <span class="n">level</span><span class="p">:</span> <span class="nb">str</span>
<span class="gp">... </span>    <span class="n">propagate</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
<p>to use TypedDict on <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> you need to wrap it inside <strong>Unpack</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Unpack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">show_options</span><span class="p">(</span><span class="n">program_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">Options</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">program_name</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">option</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">option</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You use Unpack to say that the typed dictionary provides different type hints for different keyword arguments. If you use **kwargs: Options, then you’re saying that each keyword argument should be an Options dictionary.</p>
<p>By default, all fields in a typed dictionary are required.
That means that you must pass in line_width, level, and propagate and can’t leave any of them out.
That’s not usually what you intend when using **kwargs.
You can switch this so that none of the keys are required by specifying <strong>total=False</strong> when you define the typed dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Options</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">line_width</span><span class="p">:</span> <span class="nb">int</span>
<span class="gp">... </span>    <span class="n">level</span><span class="p">:</span> <span class="nb">str</span>
<span class="gp">... </span>    <span class="n">propagate</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
<p>In this case, all the arguments are optional.
For more fine-grain control, you can also use <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Required">Required</a> and <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NotRequired">NotRequired</a>. For example, to denote that only level is required, you can do the following</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Required</span><span class="p">,</span> <span class="n">TypedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Options</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">line_width</span><span class="p">:</span> <span class="nb">int</span>
<span class="gp">... </span>    <span class="n">level</span><span class="p">:</span> <span class="n">Required</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">propagate</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Required</span><span class="p">,</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">Unpack</span>


<span class="k">class</span> <span class="nc">Options</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">line_width</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">level</span><span class="p">:</span> <span class="n">Required</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">propagate</span><span class="p">:</span> <span class="nb">bool</span>


<span class="k">def</span> <span class="nf">show_options</span><span class="p">(</span><span class="n">program_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">Options</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">program_name</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">option</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">option</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">show_options_explicit</span><span class="p">(</span>
    <span class="n">program_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">level</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">line_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">propagate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;line_width&quot;</span><span class="p">:</span> <span class="n">line_width</span><span class="p">,</span>
        <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="n">level</span><span class="p">,</span>
        <span class="s2">&quot;propagate&quot;</span><span class="p">:</span> <span class="n">propagate</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">program_name</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">option</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">option</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">show_options</span><span class="p">(</span><span class="s2">&quot;logger&quot;</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="annotated-typing">
<h1>annotated typing<a class="headerlink" href="#annotated-typing" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://github.com/annotated-types/annotated-types">annotated-types</a></p>
</section>
<section id="pydantic">
<h1>pydantic<a class="headerlink" href="#pydantic" title="Link to this heading">¶</a></h1>
<p>use pydantic for extra validation &amp; (de)serialization power</p>
<p><a class="reference external" href="https://docs.pydantic.dev/latest/">pydantic docs</a></p>
<section id="types">
<h2>types<a class="headerlink" href="#types" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.pydantic.dev/latest/concepts/types/">more on types on pydantic site</a></p>
<section id="annotated">
<h3>annotated<a class="headerlink" href="#annotated" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># or `from typing import Annotated` for Python 3.9+</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">TypeAdapter</span><span class="p">,</span> <span class="n">ValidationError</span>

<span class="n">PositiveInt</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>

<span class="n">ta</span> <span class="o">=</span> <span class="n">TypeAdapter</span><span class="p">(</span><span class="n">PositiveInt</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ta</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="c1">#&gt; 1</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">ta</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for constrained-int</span>
<span class="sd">      Input should be greater than 0 [type=greater_than, input_value=-1, input_type=int]</span>
<span class="sd">    &quot;&quot;&quot;</span>


</pre></div>
</div>
</section>
<section id="typeadapter">
<h3>TypeAdapter<a class="headerlink" href="#typeadapter" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">TypeAdapter</span><span class="p">,</span> <span class="n">BaseModel</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="k">class</span> <span class="nc">CaseInsensitiveAdapter</span><span class="p">(</span><span class="n">TypeAdapter</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">validate_python</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__lower__</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="n">__lower__</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">__lower__</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">my_property</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">adapter</span> <span class="o">=</span> <span class="n">CaseInsensitiveAdapter</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span>
<span class="n">my_obj</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate_python</span><span class="p">({</span><span class="s2">&quot;MY_PROPERTY&quot;</span><span class="p">:</span> <span class="s2">&quot;hello&quot;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_obj</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="deserialize">
<h2>deserialize<a class="headerlink" href="#deserialize" title="Link to this heading">¶</a></h2>
<section id="from-dict">
<h3>from dict<a class="headerlink" href="#from-dict" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">42</span>
<span class="p">}</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span>
<span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="from-json">
<h3>from json<a class="headerlink" href="#from-json" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_json</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">{</span>
<span class="s1">    &quot;first_name&quot;: &quot;John&quot;,</span>
<span class="s1">    &quot;last_name&quot;: &quot;Smith&quot;,</span>
<span class="s1">    &quot;age&quot;: 42</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">data_json</span><span class="p">)</span>
<span class="n">p</span>
<span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>We can inspect the model’s fields this way, to see how they are currently defined:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Person</span><span class="o">.</span><span class="n">model_fields</span>
<span class="p">{</span><span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
 <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
 <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="n">FieldInfo</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
</pre></div>
</div>
</section>
</section>
<section id="serialize">
<h2>serialize<a class="headerlink" href="#serialize" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;id_&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
<span class="s1">&#39;{&quot;id_&quot;:100,&quot;first_name&quot;:&quot;John&quot;,&quot;last_name&quot;:&quot;Smith&quot;,&quot;age&quot;:42}&#39;</span>
</pre></div>
</div>
<p>As you can see, serialization uses the field names, not the aliases to serialize.</p>
<p>Since we have aliases, we could, if we wanted to, also serialize using the aliases instead of the field names:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;First Name&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;LASTNAME&#39;</span><span class="p">:</span> <span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="s1">&#39;age in years&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">(</span><span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="s1">&#39;{&quot;id&quot;:100,&quot;First Name&quot;:&quot;John&quot;,&quot;LASTNAME&quot;:&quot;Smith&quot;,&quot;age in years&quot;:42}&#39;</span>
</pre></div>
</div>
<section id="custom-serializer">
<h3>custom serializer<a class="headerlink" href="#custom-serializer" title="Link to this heading">¶</a></h3>
<p>eg:</p>
<ul class="simple">
<li><p>specify how many digits of a float after decimal point</p></li>
<li><p>specify how datetime objects are serialized from json</p></li>
</ul>
<p>default:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">number</span><span class="p">:</span> <span class="nb">float</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mf">0.3333333333333333</span><span class="p">}</span>
</pre></div>
</div>
<p>custom:
careful since we actually have tow modes of serialization: to a Python dictionary (so Python objects), and to JSON (so strings).
to customize the float serialization to rounding to 2 decimal places, in both dictionary and JSON serialization</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">field_serializer</span>

<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">number</span><span class="p">:</span> <span class="nb">float</span>

    <span class="nd">@field_serializer</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">serialize_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">}</span>

<span class="n">m</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
<span class="s1">&#39;{&quot;number&quot;:0.33}&#39;</span>
</pre></div>
</div>
<p>datetimes get serialized to JSON using the isoformat() method of datetimes:</p>
<p>default:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<span class="s1">&#39;2023-12-06T14:33:05.667170+00:00&#39;</span>

<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n">datetime</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">))</span>
<span class="n">m</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
<span class="s1">&#39;{&quot;dt&quot;:&quot;2023-12-06T14:33:05.672674Z&quot;}&#39;</span>
</pre></div>
</div>
<p>custom:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">number</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">))</span>

    <span class="nd">@field_serializer</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">serialize_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="nd">@field_serializer</span><span class="p">(</span><span class="s2">&quot;dt&quot;</span><span class="p">,</span> <span class="n">when_used</span><span class="o">=</span><span class="s2">&quot;json-unless-none&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">serialize_datetime_to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y/%-m/</span><span class="si">%-d</span><span class="s2"> %I:%M %p&quot;</span><span class="p">)</span>

        
<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
<span class="n">Model</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mf">0.3333333333333333</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">692861</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">))</span>

<span class="n">m</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span>
 <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">692861</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)}</span>

<span class="n">m</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
<span class="s1">&#39;{&quot;number&quot;:0.33,&quot;dt&quot;:&quot;2023/12/6 02:33 PM&quot;}&#39;</span>
</pre></div>
</div>
<p>dt serialization remained unaffacted, but when we serialize to JSON, our custom serializer is used</p>
</section>
</section>
<section id="fields">
<h2>fields<a class="headerlink" href="#fields" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.pydantic.dev/latest/concepts/fields/">fields docs</a></p></li>
</ul>
<section id="alias">
<h3>alias<a class="headerlink" href="#alias" title="Link to this heading">¶</a></h3>
<p>Sometimes the data we are attempting to deserialize uses names that we simply do not, or cannot use in our model.</p>
<p>For example consider this data we would like to model using Pydantic:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;First Name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LASTNAME&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age in years&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Pydantic has a way to define an alternative name to our field names, called aliases.
Note the spaces</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">Field</span>


<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">id_</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;First Name&quot;</span><span class="p">)</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;LASTNAME&quot;</span><span class="p">)</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;age in years&quot;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span>
<span class="n">Person</span><span class="p">(</span><span class="n">id_</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="allow-not-using-alias">
<h3>allow not using alias<a class="headerlink" href="#allow-not-using-alias" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ConfigDict</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">populate_by_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;firstName&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;lastName&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>And now we can deserialize using either the alias or the field name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="n">lastName</span><span class="o">=</span><span class="s2">&quot;Smith&quot;</span><span class="p">)</span>
<span class="n">p</span>
<span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Smith&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;first_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span>
<span class="p">}</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span>
<span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Smith&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="defaults">
<h3>defaults<a class="headerlink" href="#defaults" title="Link to this heading">¶</a></h3>
<p>When we used the Field object to define an alias, we lost the ability to set our fields to some default value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;firstName&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;lastName&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Smith&quot;</span>
<span class="p">}</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span>
<span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Smith&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="mutable-defaults">
<h4>mutable defaults<a class="headerlink" href="#mutable-defaults" title="Link to this heading">¶</a></h4>
<p>Pydantic can handle is setting default values to mutable objects<br />
something that is usually problematic in Python, and disallowed (by default) in dataclasses</p>
<p>defining defaults this way is aok in Pydantic (Pydantic basically identifies mutable defaults, and creates a deepcopy of the default when creating new instances of the model):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">numbers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">m1</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>

<span class="n">m1</span><span class="o">.</span><span class="n">numbers</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">m1</span>
<span class="n">Model</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">m2</span>
<span class="n">Model</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
</section>
<section id="default-factory">
<h4>default factory<a class="headerlink" href="#default-factory" title="Link to this heading">¶</a></h4>
<p>to generate a default not as a static value, but rather as a value that should be calculated each time an instance is created that needs the default.</p>
<p>We can do that using a default factory. Basically, we provide a function that Pydantic will call to generate the default value each time a model instance is created that requires that default.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>

<span class="k">class</span> <span class="nc">Log</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">))</span>
    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>

<span class="n">log1</span> <span class="o">=</span> <span class="n">Log</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;message 1&quot;</span><span class="p">)</span>
<span class="n">log2</span> <span class="o">=</span> <span class="n">Log</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;message 2&quot;</span><span class="p">)</span>

<span class="n">log1</span>
<span class="n">Log</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">648812</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;message 1&#39;</span><span class="p">)</span>

<span class="n">log2</span>
<span class="n">Log</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">650873</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">),</span> <span class="n">message</span><span class="o">=</span><span class="s1">&#39;message 2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="validation">
<h2>validation<a class="headerlink" href="#validation" title="Link to this heading">¶</a></h2>
<p>Validators are not just validation functions, they are also transformation functions<br />
Pydantic’s validators can modify the type of the data being deserialized to coerce it into the proper type</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">PositiveInt</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>  
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;John Doe&#39;</span>  
    <span class="n">signup_ts</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span>  
    <span class="n">tastes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveInt</span><span class="p">]</span>  


<span class="n">external_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
    <span class="s1">&#39;signup_ts&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-06-01 12:22&#39;</span><span class="p">,</span>  
    <span class="s1">&#39;tastes&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;wine&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
        <span class="sa">b</span><span class="s1">&#39;cheese&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>  
        <span class="s1">&#39;cabbage&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>  
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="o">**</span><span class="n">external_data</span><span class="p">)</span>  

<span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  
<span class="c1">#&gt; 123</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>  
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">{</span>
<span class="sd">    &#39;id&#39;: 123,</span>
<span class="sd">    &#39;name&#39;: &#39;John Doe&#39;,</span>
<span class="sd">    &#39;signup_ts&#39;: datetime.datetime(2019, 6, 1, 12, 22),</span>
<span class="sd">    &#39;tastes&#39;: {&#39;wine&#39;: 9, &#39;cheese&#39;: 7, &#39;cabbage&#39;: 1},</span>
<span class="sd">}</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>If validation fails, Pydantic will raise an error with a breakdown of what was wrong:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># continuing the above example...</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;John Doe&#39;</span>
    <span class="n">signup_ts</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">tastes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveInt</span><span class="p">]</span>


<span class="n">external_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;not an int&#39;</span><span class="p">,</span> <span class="s1">&#39;tastes&#39;</span><span class="p">:</span> <span class="p">{}}</span>  

<span class="k">try</span><span class="p">:</span>
    <span class="n">User</span><span class="p">(</span><span class="o">**</span><span class="n">external_data</span><span class="p">)</span>  
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">errors</span><span class="p">())</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    [</span>
<span class="sd">        {</span>
<span class="sd">            &#39;type&#39;: &#39;int_parsing&#39;,</span>
<span class="sd">            &#39;loc&#39;: (&#39;id&#39;,),</span>
<span class="sd">            &#39;msg&#39;: &#39;Input should be a valid integer, unable to parse string as an integer&#39;,</span>
<span class="sd">            &#39;input&#39;: &#39;not an int&#39;,</span>
<span class="sd">            &#39;url&#39;: &#39;https://errors.pydantic.dev/2/v/int_parsing&#39;,</span>
<span class="sd">        },</span>
<span class="sd">        {</span>
<span class="sd">            &#39;type&#39;: &#39;missing&#39;,</span>
<span class="sd">            &#39;loc&#39;: (&#39;signup_ts&#39;,),</span>
<span class="sd">            &#39;msg&#39;: &#39;Field required&#39;,</span>
<span class="sd">            &#39;input&#39;: {&#39;id&#39;: &#39;not an int&#39;, &#39;tastes&#39;: {}},</span>
<span class="sd">            &#39;url&#39;: &#39;https://errors.pydantic.dev/2/v/missing&#39;,</span>
<span class="sd">        },</span>
<span class="sd">    ]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<section id="custom-validators">
<h3>custom validators<a class="headerlink" href="#custom-validators" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>before validator<br />
run before Pydantic has a chance to validate and coerce the data according to our field definition</p></li>
</ul>
<blockquote>
<div><p>can be very handy to provide custom parsing of data that Pydantic would otherwise be unable to do. For example deserializing a date provided in a format that Python does not recognize (e.g. 2024/1/1 3:15pm)</p>
</div></blockquote>
<ul class="simple">
<li><p>after validator</p></li>
</ul>
<blockquote>
<div><p>after Pydantic has already processed the raw data, validated it and coerced it to the proper type, as defined by the field definition</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">field_validator</span>

<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">absolute</span><span class="p">:</span> <span class="nb">int</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;absolute&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">make_absolute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>NOTE that our custom validator, being an after validator, will get called once Pydantic tried to parse the input data to an int. If that validation fails, our custom validator will not even get called.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">absolute</span><span class="p">:</span> <span class="nb">int</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;absolute&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">make_absolute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;running custom validator: </span><span class="si">{</span><span class="n">value</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># running custom validator: value=-10, type(value)=&lt;class &#39;int&#39;&gt;</span>

<span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s pass something that is not an integer, but can be coerced to an integer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=</span><span class="s2">&quot;-10&quot;</span><span class="p">)</span>
<span class="c1"># running custom validator: value=-10, type(value)=&lt;class &#39;int&#39;&gt;</span>
<span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, our validator received an integer, not a string</p>
<p>And if Pydantic’s validation fails, our validator is not called:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">absolute</span><span class="o">=</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">validation</span> <span class="n">error</span> <span class="k">for</span> <span class="n">Model</span>
<span class="n">absolute</span>
  <span class="n">Input</span> <span class="n">should</span> <span class="n">be</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">integer</span><span class="p">,</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">parse</span> <span class="n">string</span> <span class="k">as</span> <span class="n">an</span> <span class="n">integer</span> <span class="p">[</span><span class="nb">type</span><span class="o">=</span><span class="n">int_parsing</span><span class="p">,</span> <span class="n">input_value</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">input_type</span><span class="o">=</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">For</span> <span class="n">further</span> <span class="n">information</span> <span class="n">visit</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">errors</span><span class="o">.</span><span class="n">pydantic</span><span class="o">.</span><span class="n">dev</span><span class="o">/</span><span class="mf">2.4</span><span class="o">/</span><span class="n">v</span><span class="o">/</span><span class="n">int_parsing</span>
</pre></div>
</div>
<p>Notice our custom validator’s print statement never executed.
We can of course, also use custom validators to perform validation.</p>
<p>Let’s say we want to define a field that should be a list of unique integers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">numbers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;numbers&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ensure_unique</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">numbers</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">numbers</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;elements must be unique&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">numbers</span>

<span class="n">Model</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">validation</span> <span class="n">error</span> <span class="k">for</span> <span class="n">Model</span>
<span class="n">numbers</span>
  <span class="n">Value</span> <span class="n">error</span><span class="p">,</span> <span class="n">elements</span> <span class="n">must</span> <span class="n">be</span> <span class="n">unique</span> <span class="p">[</span><span class="nb">type</span><span class="o">=</span><span class="n">value_error</span><span class="p">,</span> <span class="n">input_value</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">input_type</span><span class="o">=</span><span class="nb">list</span><span class="p">]</span>
    <span class="n">For</span> <span class="n">further</span> <span class="n">information</span> <span class="n">visit</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">errors</span><span class="o">.</span><span class="n">pydantic</span><span class="o">.</span><span class="n">dev</span><span class="o">/</span><span class="mf">2.4</span><span class="o">/</span><span class="n">v</span><span class="o">/</span><span class="n">value_error</span>
</pre></div>
</div>
<p>Notice how I raised a ValueError error.<br />
If you want to raise a Pydantic ValidationException, you should raise a ValueError<br />
Most of the other exception types (such as TypeError, KeyError, etc) will bubble up as those exceptions, not a ValidationError exception)<br />
There are a few other errors you can raise that will result in a ValidationError exception, but by far ValueError is the easiest and safest way to do so</p>
</section>
</section>
<section id="nested-models">
<h2>nested models<a class="headerlink" href="#nested-models" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;firstName&quot;</span><span class="p">:</span> <span class="s2">&quot;Arthur&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lastName&quot;</span><span class="p">:</span> <span class="s2">&quot;Bourne&quot;</span><span class="p">,</span>
    <span class="s2">&quot;born&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;place&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Mars Colony&quot;</span><span class="p">,</span>
            <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;Central City&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;3001-01-01&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As you can see we have three levels of nested dictionaries - which we can model this way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="k">class</span> <span class="nc">Place</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">country</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">city</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span> <span class="nc">Born</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">place</span><span class="p">:</span> <span class="n">Place</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n">date</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">first_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;firstName&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">last_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;lastName&quot;</span><span class="p">)</span>
    <span class="n">born</span><span class="p">:</span> <span class="n">Born</span>


<span class="n">arthur</span> <span class="o">=</span> <span class="n">Person</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">arthur</span>
<span class="n">Person</span><span class="p">(</span><span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;Arthur&#39;</span><span class="p">,</span> <span class="n">last_name</span><span class="o">=</span><span class="s1">&#39;Bourne&#39;</span><span class="p">,</span> <span class="n">born</span><span class="o">=</span><span class="n">Born</span><span class="p">(</span><span class="n">place</span><span class="o">=</span><span class="n">Place</span><span class="p">(</span><span class="n">country</span><span class="o">=</span><span class="s1">&#39;Mars Colony&#39;</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">&#39;Central City&#39;</span><span class="p">),</span> <span class="n">dt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">3001</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="c1"># access all these fields using object dot notation:</span>
<span class="n">arthur</span><span class="o">.</span><span class="n">born</span><span class="o">.</span><span class="n">place</span><span class="o">.</span><span class="n">country</span>
<span class="s1">&#39;Mars Colony&#39;</span>
</pre></div>
</div>
</section>
<section id="validate-call">
<h2>validate call<a class="headerlink" href="#validate-call" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.pydantic.dev/latest/concepts/validation_decorator/">docs on validate call</a></p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;validate_call</span></code> can also be used on async functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Connection</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;testing@example.com&quot;</span>


<span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">()</span>
<span class="c1"># ignore-above</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">PositiveInt</span><span class="p">,</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">validate_call</span>


<span class="nd">@validate_call</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_user_email</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="n">PositiveInt</span><span class="p">):</span>
    <span class="c1"># `conn` is some fictional connection to a database</span>
    <span class="n">email</span> <span class="o">=</span> <span class="k">await</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select email from users where id=$1&quot;</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">email</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;user not found&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">email</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">email</span> <span class="o">=</span> <span class="k">await</span> <span class="n">get_user_email</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
    <span class="c1">#&gt; testing@example.com</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">get_user_email</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">errors</span><span class="p">())</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        [</span>
<span class="sd">            {</span>
<span class="sd">                &#39;type&#39;: &#39;greater_than&#39;,</span>
<span class="sd">                &#39;loc&#39;: (0,),</span>
<span class="sd">                &#39;msg&#39;: &#39;Input should be greater than 0&#39;,</span>
<span class="sd">                &#39;input&#39;: -4,</span>
<span class="sd">                &#39;ctx&#39;: {&#39;gt&#39;: 0},</span>
<span class="sd">                &#39;url&#39;: &#39;https://errors.pydantic.dev/2/v/greater_than&#39;,</span>
<span class="sd">            }</span>
<span class="sd">        ]</span>
<span class="sd">        &quot;&quot;&quot;</span>


<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
<span class="c1"># requires: `conn.execute()` that will return `&#39;testing@example.com&#39;`</span>
</pre></div>
</div>
<p>The model behind &#64;validate_call can be customised using a config setting, which is equivalent to setting the ConfigDict sub-class in normal models</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">validate_call</span>


<span class="k">class</span> <span class="nc">Foobar</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Foobar&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Foobar(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="si">}</span><span class="s2">)&quot;</span>


<span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">add_foobars</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Foobar</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Foobar</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="n">c</span> <span class="o">=</span> <span class="n">add_foobars</span><span class="p">(</span><span class="n">Foobar</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span> <span class="n">Foobar</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="c1">#&gt; Foobar(a) + Foobar(b)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">add_foobars</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2 validation errors for add_foobars</span>
<span class="sd">    0</span>
<span class="sd">      Input should be an instance of Foobar [type=is_instance_of, input_value=1, input_type=int]</span>
<span class="sd">    1</span>
<span class="sd">      Input should be an instance of Foobar [type=is_instance_of, input_value=2, input_type=int]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>pandas example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">some_function</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="c1"># do something</span>
    <span class="k">return</span> <span class="n">my_dict</span>
</pre></div>
</div>
</section>
<section id="real-world-example">
<h2>real world example<a class="headerlink" href="#real-world-example" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">,</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span><span class="p">,</span> <span class="n">Flag</span><span class="p">,</span> <span class="n">StrEnum</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">UNIQUE</span><span class="p">,</span> <span class="n">CONTINUOUS</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="c1"># https://docs.python.org/3/library/enum.html#enum.Flag</span>
<span class="c1"># https://docs.python.org/3/howto/enum.html#enum-cookbook</span>
<span class="c1"># https://typing.readthedocs.io/en/latest/spec/typeddict.html</span>
<span class="c1"># https://docs.pydantic.dev/2.0/migration/#required-optional-and-nullable-fields</span>


<span class="nd">@verify</span><span class="p">(</span><span class="n">UNIQUE</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">VoteValue</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vote value for a proposal&quot;&quot;&quot;</span>
    <span class="n">VALUE_UNSPECIFIED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Default value, always invalid</span>
    <span class="n">VALUE_NO</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># A vote against the proposal</span>
    <span class="n">VALUE_YES</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># A vote in favour of the proposal</span>


<span class="nd">@verify</span><span class="p">(</span><span class="n">UNIQUE</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ProposalState</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Proposal states&quot;&quot;&quot;</span>
    <span class="n">STATE_UNSPECIFIED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Default value, always invalid</span>
    <span class="n">STATE_FAILED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Proposal enactment has failed - even though proposal has passed, its execution could not be performed</span>
    <span class="n">STATE_OPEN</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Proposal is open for voting</span>
    <span class="n">STATE_PASSED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Proposal has gained enough support to be executed</span>
    <span class="n">STATE_REJECTED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Proposal wasn&#39;t accepted (proposal terms failed validation due to wrong configuration or failing to meet network requirements)</span>
    <span class="n">STATE_DECLINED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Proposal didn&#39;t get enough votes (either failing to gain required participation or majority level)</span>
    <span class="n">STATE_ENACTED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Proposal enacted</span>
    <span class="n">STATE_WAITING_FOR_NODE_VOTE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Waiting for node validation of the proposal</span>

<span class="nd">@verify</span><span class="p">(</span><span class="n">UNIQUE</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ProposalType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Proposal types&quot;&quot;&quot;</span>
    <span class="n">TYPE_UNSPECIFIED</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Default value, always invalid</span>
    <span class="n">TYPE_ALL</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># List all proposals</span>
    <span class="n">TYPE_NEW_MARKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># List new market proposals</span>
    <span class="n">TYPE_UPDATE_MARKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># List update market proposals</span>
    <span class="n">TYPE_NETWORK_PARAMETERS</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># List change network parameter proposals</span>
    <span class="n">TYPE_NEW_ASSET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># New asset proposals</span>
    <span class="n">TYPE_NEW_FREE_FORM</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># for creating n ew free form proposal</span>
    <span class="n">TYPE_UPDATE_ASSET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Update asset proposals</span>
    <span class="n">TYPE_NEW_SPOT_MARKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># New spot market proposals</span>
    <span class="n">TYPE_UPDATE_SPOT_MARKET</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Update existing spot market</span>
    <span class="n">TYPE_NEW_TRANSFER</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># New transfer proposal</span>
    <span class="n">TYPE_CANCEL_TRANSFER</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Cancel transfer</span>
    <span class="n">TYPE_UPDATE_MARKET_STATE</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Update market state</span>
    <span class="n">TYPE_UPDATE_REFERRAL_PROGRAM</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Update referral program</span>
    <span class="n">TYPE_UPDATE_VOLUME_DISCOUNT_PROGRAM</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>  <span class="c1"># Update volume discount program</span>

<span class="k">class</span> <span class="nc">Pagination</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validate_assignment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">first</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Number of records to be returned that sort greater than row identified by cursor supplied in &#39;after&#39;</span>
    <span class="n">after</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># If paging forwards, the cursor string for the last row of the previous page</span>
    <span class="n">last</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int32</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Number of records to be returned that sort less than row identified by cursor supplied in &#39;before&#39;</span>
    <span class="n">before</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># If paging forwards, the cursor string for the first row of the previous page</span>
    <span class="n">newestFirst</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Whether to order the results with the newest records first</span>


<span class="c1"># PartyId = Annotated[str, StringConstraints(min_length=64, max_length=64)]</span>
<span class="c1"># PartyId = Annotated[str, Field(pattern=r&#39;[a-fA-F0-9]{64}&#39;]</span>
<span class="c1"># PartyId = Annotated[str, StringConstraints(pattern=r&#39;[a-fA-F0-9]{64}&#39;]</span>
<span class="c1"># PartyId = Annotated[str, Field(min_length=64, max_length=64, pattern=r&#39;[a-fA-F0-9]{64}&#39;, validate_default=True)]</span>


<span class="k">class</span> <span class="nc">QueryAllProposals</span><span class="p">(</span><span class="n">Pagination</span><span class="p">):</span>  <span class="c1"># list of proposals doesn&#39;t need pagination, just testing inheritance</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query a list of all proposals&quot;&quot;&quot;</span>
    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">validate_assignment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">proposalState</span><span class="p">:</span> <span class="n">ProposalState</span> <span class="o">=</span> <span class="n">ProposalState</span><span class="o">.</span><span class="n">STATE_UNSPECIFIED</span>
    <span class="n">proposalType</span><span class="p">:</span> <span class="n">ProposalType</span> <span class="o">=</span> <span class="n">ProposalType</span><span class="o">.</span><span class="n">TYPE_UNSPECIFIED</span>
    <span class="n">proposerPartyId</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;[a-fA-F0-9]</span><span class="si">{64}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># restrict proposal to those proposed by the given party ID</span>
    <span class="n">proposalReference</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Restrict proposals to those with the given reference</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ConditionOperator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ConditionOperator</span><span class="o">.</span><span class="n">OPERATOR_EQUALS</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">OrderTimeInForce</span><span class="o">.</span><span class="n">TIME_IN_FORCE_GFA</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">OrderTimeInForce</span><span class="o">.</span><span class="n">TIME_IN_FORCE_GFA</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">VoteValue</span><span class="o">.</span><span class="n">VALUE_NO</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">params_allProposals</span> <span class="o">=</span> <span class="n">QueryAllProposals</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">params_allProposals</span><span class="o">.</span><span class="n">proposerPartyId</span> <span class="o">=</span> <span class="s2">&quot;000000000not00000640000in0000length0000000000000000000000&quot;</span>  <span class="c1"># 57 chars</span>
    <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">pprint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">errors</span><span class="p">())</span>
    <span class="n">params_allProposals</span><span class="o">.</span><span class="n">proposerPartyId</span> <span class="o">=</span> <span class="s2">&quot;0000000000000000000000000000000000000000000000000000000000000000&quot;</span>  <span class="c1"># 64 chars</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">params_allProposals</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ConditionOperator.OPERATOR_GREATER_THAN</span>
<span class="sd">    2</span>
<span class="sd">    time_in_force_gfa</span>
<span class="sd">    time_in_force_gfa</span>
<span class="sd">    2</span>
<span class="sd">    [{&#39;ctx&#39;: {&#39;pattern&#39;: &#39;[a-fA-F0-9]{64}&#39;},</span>
<span class="sd">      &#39;input&#39;: &#39;000000000not00000640000in0000length0000000000000000000000&#39;,</span>
<span class="sd">      &#39;loc&#39;: (&#39;proposerPartyId&#39;,),</span>
<span class="sd">      &#39;msg&#39;: &quot;String should match pattern &#39;[a-fA-F0-9]{64}&#39;&quot;,</span>
<span class="sd">      &#39;type&#39;: &#39;string_pattern_mismatch&#39;,</span>
<span class="sd">      &#39;url&#39;: &#39;https://errors.pydantic.dev/2.6/v/string_pattern_mismatch&#39;}]</span>
<span class="sd">    QueryAllProposals(proposalState=&lt;ProposalState.STATE_UNSPECIFIED: &#39;state_unspecified&#39;&gt;, proposalType=&lt;ProposalType.TYPE_UNSPECIFIED: &#39;type_unspecified&#39;&gt;, proposerPartyId=&#39;0000000000000000000000000000000000000000000000000000000000000000&#39;, proposalReference=None)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">main</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ai/index.html">ai</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sphinx.html">sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash/index.html">bash</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">python</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="assert.html">assert</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio.html">asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">core</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataclass.html">dataclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataclass.html#attrs">Attrs</a></li>
<li class="toctree-l2"><a class="reference internal" href="designpatterns.html">design patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_ops.html">glob</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html">functional programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="pandas.html">pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyenv.html">pyenv</a></li>
<li class="toctree-l2"><a class="reference internal" href="regex.html">regex</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">pytest</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#annotated-typing">annotated typing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pydantic">pydantic</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">code library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../vim/index.html">vim</a></li>
</ul>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">typing</a><ul>
<li><a class="reference internal" href="#use-abcs-for-typing">use ABCs for typing</a></li>
<li><a class="reference internal" href="#enums">enums</a><ul>
<li><a class="reference internal" href="#auto">auto</a><ul>
<li><a class="reference internal" href="#overriding-auto">overriding auto</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#functions">functions</a></li>
<li><a class="reference internal" href="#classes">classes</a></li>
<li><a class="reference internal" href="#duck-types">duck types</a></li>
<li><a class="reference internal" href="#asyncs">asyncs</a><ul>
<li><a class="reference internal" href="#async-iterators">async iterators</a></li>
<li><a class="reference internal" href="#async-generators">async generators</a></li>
<li><a class="reference internal" href="#gotchas">gotchas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#type-aliases">type aliases</a></li>
<li><a class="reference internal" href="#newtype">NewType</a></li>
<li><a class="reference internal" href="#annotating-callables">annotating callables</a><ul>
<li><a class="reference internal" href="#ellepsis">ellepsis …</a></li>
</ul>
</li>
<li><a class="reference internal" href="#abcs">ABCs</a></li>
<li><a class="reference internal" href="#generics">generics</a></li>
<li><a class="reference internal" href="#override">override</a></li>
<li><a class="reference internal" href="#typeddict-kwargs">TypedDict &amp; **kwargs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#annotated-typing">annotated typing</a></li>
<li><a class="reference internal" href="#pydantic">pydantic</a><ul>
<li><a class="reference internal" href="#types">types</a><ul>
<li><a class="reference internal" href="#annotated">annotated</a></li>
<li><a class="reference internal" href="#typeadapter">TypeAdapter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deserialize">deserialize</a><ul>
<li><a class="reference internal" href="#from-dict">from dict</a></li>
<li><a class="reference internal" href="#from-json">from json</a></li>
</ul>
</li>
<li><a class="reference internal" href="#serialize">serialize</a><ul>
<li><a class="reference internal" href="#custom-serializer">custom serializer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fields">fields</a><ul>
<li><a class="reference internal" href="#alias">alias</a></li>
<li><a class="reference internal" href="#allow-not-using-alias">allow not using alias</a></li>
<li><a class="reference internal" href="#defaults">defaults</a><ul>
<li><a class="reference internal" href="#mutable-defaults">mutable defaults</a></li>
<li><a class="reference internal" href="#default-factory">default factory</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#validation">validation</a><ul>
<li><a class="reference internal" href="#custom-validators">custom validators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nested-models">nested models</a></li>
<li><a class="reference internal" href="#validate-call">validate call</a></li>
<li><a class="reference internal" href="#real-world-example">real world example</a></li>
</ul>
</li>
</ul>

  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="examples.html" title="code library"
             >next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="pytest"
             >previous</a> |</li>
          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="../index.html">PowrUsr Docs alpha documentation</a> &#187;
              
          </li>
          <li class="nav-item nav-item-1"><a href="index.html" >python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">typing</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; Copyright 2023, PowrUsr.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Last updated on 2024-02-26.
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>

  </body>
</html>